<h3><strong>Introduction</strong></h3>

<p>Bel-T is a 128-bit block cipher that was adopted as a standard by the Republic of Belarus in 2011 and defined in <a href="http://apmi.bsu.by/assets/files/std/belt-spec27.pdf">STB 34.101.31-2011</a>. It takes 128-bits of data and encrypts using an N-bit key (where N can be 128, 192 or 256). It uses 8 rounds of a function based on the <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.14.3451&amp;rep=rep1&amp;type=pdf">Lai-Massey</a> scheme also used by IDEA and IDEA-NXT. There's a key schedule procedure, but because it's only relevant for 128 and 192-bit keys, it's not included here. If you're interested in the key scheduling function, you can find it in <a href="https://github.com/Daeinar/belt">this implementation</a> written by <a href="https://zerobyte.io/">Philipp Jovanovic</a>. This implementation only performs encryption and is optimized for size rather than speed.</p>

<h3><strong>Compact code</strong></h3>

<pre style='color:#000000;background:#ffffff;'><span style='color:#004a43; '>#</span><span style='color:#004a43; '>define</span><span style='color:#004a43; '> R</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>v</span><span style='color:#808030; '>,</span><span style='color:#004a43; '>n</span><span style='color:#808030; '>)</span><span style='color:#808030; '>(</span><span style='color:#808030; '>(</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>v</span><span style='color:#808030; '>)</span><span style='color:#808030; '>&lt;</span><span style='color:#808030; '>&lt;</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>n</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>|</span><span style='color:#808030; '>(</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>v</span><span style='color:#808030; '>)</span><span style='color:#808030; '>></span><span style='color:#808030; '>></span><span style='color:#808030; '>(</span><span style='color:#004a43; '>32</span><span style='color:#808030; '>-</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>n</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span>
<span style='color:#004a43; '>#</span><span style='color:#004a43; '>define</span><span style='color:#004a43; '> X</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>u</span><span style='color:#808030; '>,</span><span style='color:#004a43; '>v</span><span style='color:#808030; '>)</span><span style='color:#004a43; '>t</span><span style='color:#808030; '>=</span><span style='color:#004a43; '>u</span><span style='color:#808030; '>,</span><span style='color:#004a43; '>u</span><span style='color:#808030; '>=</span><span style='color:#004a43; '>v</span><span style='color:#808030; '>,</span><span style='color:#004a43; '>v</span><span style='color:#808030; '>=</span><span style='color:#004a43; '>t</span>
<span style='color:#004a43; '>#</span><span style='color:#004a43; '>define</span><span style='color:#004a43; '> F</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>n</span><span style='color:#808030; '>)</span><span style='color:#004a43; '>for</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>i</span><span style='color:#808030; '>=</span><span style='color:#004a43; '>0</span><span style='color:#808030; '>;</span><span style='color:#004a43; '>i</span><span style='color:#808030; '>&lt;</span><span style='color:#004a43; '>n</span><span style='color:#808030; '>;</span><span style='color:#004a43; '>i</span><span style='color:#808030; '>+</span><span style='color:#808030; '>+</span><span style='color:#808030; '>)</span>
<span style='color:#800000; font-weight:bold; '>typedef</span> <span style='color:#800000; font-weight:bold; '>unsigned</span> <span style='color:#800000; font-weight:bold; '>char</span> B<span style='color:#800080; '>;</span>
<span style='color:#800000; font-weight:bold; '>typedef</span> <span style='color:#800000; font-weight:bold; '>unsigned</span> <span style='color:#800000; font-weight:bold; '>int</span> W<span style='color:#800080; '>;</span>

<span style='color:#004a43; '>#</span><span style='color:#004a43; '>ifdef</span><span style='color:#004a43; '> LUT</span>
<span style='color:#696969; '>// sbox</span>
B H<span style='color:#808030; '>[</span><span style='color:#008c00; '>256</span><span style='color:#808030; '>]</span> <span style='color:#808030; '>=</span>
  <span style='color:#800080; '>{</span> <span style='color:#008000; '>0xB1</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x94</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xBA</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xC8</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x0A</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x08</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xF5</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x3B</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0x36</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x6D</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x00</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x8E</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x58</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x4A</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x5D</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xE4</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0x85</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x04</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xFA</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x9D</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x1B</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xB6</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xC7</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xAC</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0x25</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x2E</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x72</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xC2</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x02</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xFD</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xCE</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x0D</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0x5B</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xE3</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xD6</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x12</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x17</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xB9</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x61</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x81</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0xFE</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x67</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x86</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xAD</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x71</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x6B</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x89</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x0B</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0x5C</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xB0</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xC0</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xFF</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x33</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xC3</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x56</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xB8</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0x35</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xC4</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x05</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xAE</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xD8</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xE0</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x7F</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x99</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0xE1</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x2B</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xDC</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x1A</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xE2</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x82</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x57</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xEC</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0x70</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x3F</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xCC</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xF0</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x95</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xEE</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x8D</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xF1</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0xC1</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xAB</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x76</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x38</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x9F</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xE6</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x78</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xCA</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0xF7</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xC6</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xF8</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x60</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xD5</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xBB</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x9C</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x4F</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0xF3</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x3C</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x65</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x7B</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x63</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x7C</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x30</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x6A</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0xDD</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x4E</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xA7</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x79</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x9E</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xB2</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x3D</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x31</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0x3E</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x98</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xB5</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x6E</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x27</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xD3</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xBC</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xCF</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0x59</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x1E</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x18</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x1F</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x4C</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x5A</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xB7</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x93</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0xE9</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xDE</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xE7</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x2C</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x8F</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x0C</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x0F</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xA6</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0x2D</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xDB</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x49</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xF4</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x6F</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x73</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x96</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x47</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0x06</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x07</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x53</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x16</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xED</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x24</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x7A</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x37</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0x39</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xCB</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xA3</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x83</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x03</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xA9</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x8B</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xF6</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0x92</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xBD</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x9B</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x1C</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xE5</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xD1</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x41</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x01</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0x54</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x45</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xFB</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xC9</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x5E</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x4D</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x0E</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xF2</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0x68</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x20</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x80</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xAA</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x22</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x7D</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x64</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x2F</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0x26</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x87</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xF9</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x34</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x90</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x40</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x55</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x11</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0xBE</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x32</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x97</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x13</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x43</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xFC</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x9A</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x48</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0xA0</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x2A</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x88</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x5F</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x19</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x4B</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x09</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xA1</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0x7E</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xCD</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xA4</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xD0</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x15</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x44</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xAF</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x8C</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0xA5</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x84</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x50</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xBF</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x66</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xD2</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xE8</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x8A</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0xA2</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xD7</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x46</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x52</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x42</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xA8</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xDF</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xB3</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0x69</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x74</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xC5</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x51</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xEB</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x23</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x29</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x21</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0xD4</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xEF</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xD9</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xB4</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x3A</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x62</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x28</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x75</span><span style='color:#808030; '>,</span>
    <span style='color:#008000; '>0x91</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x14</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x10</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xEA</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x77</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x6C</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xDA</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x1D</span> <span style='color:#800080; '>}</span><span style='color:#800080; '>;</span>
<span style='color:#004a43; '>#</span><span style='color:#004a43; '>else</span>
B H<span style='color:#808030; '>(</span>B x<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
    W i<span style='color:#808030; '>,</span> j<span style='color:#800080; '>;</span>
    B t <span style='color:#808030; '>=</span> <span style='color:#008000; '>0x1d</span><span style='color:#808030; '>,</span> w<span style='color:#800080; '>;</span>
    
    <span style='color:#800000; font-weight:bold; '>if</span><span style='color:#808030; '>(</span>x<span style='color:#808030; '>=</span><span style='color:#808030; '>=</span><span style='color:#008c00; '>10</span><span style='color:#808030; '>)</span> <span style='color:#800000; font-weight:bold; '>return</span> <span style='color:#008c00; '>0</span><span style='color:#800080; '>;</span>
    <span style='color:#800000; font-weight:bold; '>if</span><span style='color:#808030; '>(</span>x<span style='color:#808030; '>&lt;</span><span style='color:#008c00; '>10</span><span style='color:#808030; '>)</span> x<span style='color:#808030; '>+</span><span style='color:#808030; '>+</span><span style='color:#800080; '>;</span>
    
    <span style='color:#800000; font-weight:bold; '>do</span> <span style='color:#800080; '>{</span>
      j<span style='color:#808030; '>=</span><span style='color:#008c00; '>116</span><span style='color:#800080; '>;</span>
      <span style='color:#800000; font-weight:bold; '>do</span> <span style='color:#800080; '>{</span>
        w<span style='color:#808030; '>=</span>t<span style='color:#808030; '>&amp;</span><span style='color:#008c00; '>99</span><span style='color:#808030; '>,</span>
        w<span style='color:#808030; '>^</span><span style='color:#808030; '>=</span>w<span style='color:#808030; '>></span><span style='color:#808030; '>></span><span style='color:#008c00; '>1</span><span style='color:#808030; '>,</span>w<span style='color:#808030; '>^</span><span style='color:#808030; '>=</span>w<span style='color:#808030; '>></span><span style='color:#808030; '>></span><span style='color:#008c00; '>2</span><span style='color:#808030; '>,</span>w<span style='color:#808030; '>^</span><span style='color:#808030; '>=</span>w<span style='color:#808030; '>></span><span style='color:#808030; '>></span><span style='color:#008c00; '>4</span><span style='color:#808030; '>,</span>
        t<span style='color:#808030; '>=</span>t<span style='color:#808030; '>></span><span style='color:#808030; '>></span><span style='color:#008c00; '>1</span><span style='color:#808030; '>|</span>w<span style='color:#808030; '>&lt;</span><span style='color:#808030; '>&lt;</span><span style='color:#008c00; '>7</span><span style='color:#800080; '>;</span>
      <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>while</span><span style='color:#808030; '>(</span><span style='color:#808030; '>-</span><span style='color:#808030; '>-</span>j<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
    <span style='color:#800080; '>}</span> <span style='color:#800000; font-weight:bold; '>while</span> <span style='color:#808030; '>(</span><span style='color:#808030; '>-</span><span style='color:#808030; '>-</span>x<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
    <span style='color:#800000; font-weight:bold; '>return</span> t<span style='color:#800080; '>;</span>
<span style='color:#800080; '>}</span>
<span style='color:#004a43; '>#</span><span style='color:#004a43; '>endif</span>

<span style='color:#696969; '>// non-linear + linear layer</span>
W G<span style='color:#808030; '>(</span>W x<span style='color:#808030; '>,</span> W <span style='color:#808030; '>*</span>key<span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>int</span> idx<span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>int</span> r<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
    W i<span style='color:#808030; '>,</span> w<span style='color:#800080; '>;</span>
    
    w<span style='color:#808030; '>=</span>key<span style='color:#808030; '>[</span>idx<span style='color:#808030; '>%</span><span style='color:#008c00; '>8</span><span style='color:#808030; '>]</span><span style='color:#808030; '>+</span>x<span style='color:#800080; '>;</span>
    F<span style='color:#808030; '>(</span><span style='color:#008c00; '>4</span><span style='color:#808030; '>)</span>w<span style='color:#808030; '>=</span><span style='color:#808030; '>(</span>w<span style='color:#808030; '>&amp;</span><span style='color:#808030; '>-</span><span style='color:#008c00; '>256</span><span style='color:#808030; '>)</span><span style='color:#808030; '>|</span> 
<span style='color:#004a43; '>#</span><span style='color:#004a43; '>ifdef</span><span style='color:#004a43; '> LUT</span>
      H<span style='color:#808030; '>[</span>w<span style='color:#808030; '>&amp;</span><span style='color:#008c00; '>255</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span>
<span style='color:#004a43; '>#</span><span style='color:#004a43; '>else</span>
      H<span style='color:#808030; '>(</span>w<span style='color:#808030; '>&amp;</span><span style='color:#008c00; '>255</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span>
<span style='color:#004a43; '>#</span><span style='color:#004a43; '>endif</span>
      w<span style='color:#808030; '>=</span>R<span style='color:#808030; '>(</span>w<span style='color:#808030; '>,</span><span style='color:#008c00; '>8</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
    <span style='color:#800000; font-weight:bold; '>return</span> R<span style='color:#808030; '>(</span>w<span style='color:#808030; '>,</span> r<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
<span style='color:#800080; '>}</span>

<span style='color:#800000; font-weight:bold; '>void</span> belt<span style='color:#808030; '>(</span><span style='color:#800000; font-weight:bold; '>void</span><span style='color:#808030; '>*</span>mk<span style='color:#808030; '>,</span><span style='color:#800000; font-weight:bold; '>void</span><span style='color:#808030; '>*</span>data<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
    W a<span style='color:#808030; '>,</span>b<span style='color:#808030; '>,</span>c<span style='color:#808030; '>,</span>d<span style='color:#808030; '>,</span>i<span style='color:#808030; '>,</span>j<span style='color:#808030; '>,</span>t<span style='color:#808030; '>,</span>e<span style='color:#808030; '>,</span><span style='color:#808030; '>*</span>x<span style='color:#808030; '>=</span><span style='color:#808030; '>(</span>W<span style='color:#808030; '>*</span><span style='color:#808030; '>)</span>data<span style='color:#808030; '>,</span><span style='color:#808030; '>*</span>k<span style='color:#808030; '>=</span><span style='color:#808030; '>(</span>W<span style='color:#808030; '>*</span><span style='color:#808030; '>)</span>mk<span style='color:#800080; '>;</span>
    
    a<span style='color:#808030; '>=</span>x<span style='color:#808030; '>[</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span>b<span style='color:#808030; '>=</span>x<span style='color:#808030; '>[</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span>c<span style='color:#808030; '>=</span>x<span style='color:#808030; '>[</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span>d<span style='color:#808030; '>=</span>x<span style='color:#808030; '>[</span><span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span><span style='color:#800080; '>;</span>
    
    <span style='color:#800000; font-weight:bold; '>for</span><span style='color:#808030; '>(</span>i<span style='color:#808030; '>=</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>,</span>j<span style='color:#808030; '>=</span><span style='color:#008c00; '>0</span><span style='color:#800080; '>;</span>i<span style='color:#808030; '>&lt;</span><span style='color:#008c00; '>8</span><span style='color:#800080; '>;</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
      b<span style='color:#808030; '>^</span><span style='color:#808030; '>=</span>G<span style='color:#808030; '>(</span>a<span style='color:#808030; '>,</span>k<span style='color:#808030; '>,</span>j<span style='color:#808030; '>+</span><span style='color:#808030; '>+</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>5</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span>c<span style='color:#808030; '>^</span><span style='color:#808030; '>=</span>G<span style='color:#808030; '>(</span>d<span style='color:#808030; '>,</span>k<span style='color:#808030; '>,</span>j<span style='color:#808030; '>+</span><span style='color:#808030; '>+</span><span style='color:#808030; '>,</span>  <span style='color:#008c00; '>21</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span>
      a<span style='color:#808030; '>-</span><span style='color:#808030; '>=</span>G<span style='color:#808030; '>(</span>b<span style='color:#808030; '>,</span>k<span style='color:#808030; '>,</span>j<span style='color:#808030; '>+</span><span style='color:#808030; '>+</span><span style='color:#808030; '>,</span><span style='color:#008c00; '>13</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span>e <span style='color:#808030; '>=</span>G<span style='color:#808030; '>(</span>b<span style='color:#808030; '>+</span>c<span style='color:#808030; '>,</span>k<span style='color:#808030; '>,</span>j<span style='color:#808030; '>+</span><span style='color:#808030; '>+</span><span style='color:#808030; '>,</span><span style='color:#008c00; '>21</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span>
      e<span style='color:#808030; '>^</span><span style='color:#808030; '>=</span><span style='color:#808030; '>+</span><span style='color:#808030; '>+</span>i<span style='color:#808030; '>,</span>b<span style='color:#808030; '>+</span><span style='color:#808030; '>=</span>e<span style='color:#808030; '>,</span>c<span style='color:#808030; '>-</span><span style='color:#808030; '>=</span>e<span style='color:#808030; '>,</span>d<span style='color:#808030; '>+</span><span style='color:#808030; '>=</span>G<span style='color:#808030; '>(</span>c<span style='color:#808030; '>,</span>k<span style='color:#808030; '>,</span>j<span style='color:#808030; '>+</span><span style='color:#808030; '>+</span><span style='color:#808030; '>,</span>  <span style='color:#008c00; '>13</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span>
      b<span style='color:#808030; '>^</span><span style='color:#808030; '>=</span>G<span style='color:#808030; '>(</span>a<span style='color:#808030; '>,</span>k<span style='color:#808030; '>,</span>j<span style='color:#808030; '>+</span><span style='color:#808030; '>+</span><span style='color:#808030; '>,</span><span style='color:#008c00; '>21</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span>c<span style='color:#808030; '>^</span><span style='color:#808030; '>=</span>G<span style='color:#808030; '>(</span>d<span style='color:#808030; '>,</span>k<span style='color:#808030; '>,</span>j<span style='color:#808030; '>+</span><span style='color:#808030; '>+</span><span style='color:#808030; '>,</span>   <span style='color:#008c00; '>5</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span>
      X<span style='color:#808030; '>(</span>a<span style='color:#808030; '>,</span>b<span style='color:#808030; '>)</span><span style='color:#808030; '>,</span>X<span style='color:#808030; '>(</span>c<span style='color:#808030; '>,</span>d<span style='color:#808030; '>)</span><span style='color:#808030; '>,</span>X<span style='color:#808030; '>(</span>b<span style='color:#808030; '>,</span>c<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
    <span style='color:#800080; '>}</span>
    x<span style='color:#808030; '>[</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>b<span style='color:#808030; '>,</span>x<span style='color:#808030; '>[</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>d<span style='color:#808030; '>,</span>x<span style='color:#808030; '>[</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>a<span style='color:#808030; '>,</span>x<span style='color:#808030; '>[</span><span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>c<span style='color:#800080; '>;</span>
<span style='color:#800080; '>}</span>
</pre>

<h3><strong>x86 assembly</strong></h3>

<pre style='color:#000000;background:#ffffff;'><span style='color:#696969; '>; -----------------------------------------------</span>
<span style='color:#696969; '>; Bel-T block cipher in x86 assembly (encryption only)</span>
<span style='color:#696969; '>;</span>
<span style='color:#696969; '>; size: 210 bytes</span>
<span style='color:#696969; '>;</span>
<span style='color:#696969; '>; global calls use cdecl convention</span>
<span style='color:#696969; '>;</span>
<span style='color:#696969; '>; -----------------------------------------------</span>

    <span style='color:#004a43; '>bits</span> <span style='color:#008c00; '>32</span>
    
<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;</span><span style='color:#004a43; '>%ifndef</span><span style='color:#004a43; '> BIN</span>
      <span style='color:#004a43; '>global</span> belt
      <span style='color:#004a43; '>global</span> _belt
<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;</span><span style='color:#004a43; '>%endif</span>
    
<span style='color:#004a43; '>struc</span> pushad_t
  _edi <span style='color:#004a43; '>dd</span> <span style='color:#808030; '>?</span>
  _esi <span style='color:#004a43; '>dd</span> <span style='color:#808030; '>?</span>
  _ebp <span style='color:#004a43; '>dd</span> <span style='color:#808030; '>?</span>
  _esp <span style='color:#004a43; '>dd</span> <span style='color:#808030; '>?</span>
  _ebx <span style='color:#004a43; '>dd</span> <span style='color:#808030; '>?</span>
  _edx <span style='color:#004a43; '>dd</span> <span style='color:#808030; '>?</span>
  _ecx <span style='color:#004a43; '>dd</span> <span style='color:#808030; '>?</span>
  _eax <span style='color:#004a43; '>dd</span> <span style='color:#808030; '>?</span>
<span style='color:#e34adc; '>&#xa0;&#xa0;.size:</span>
<span style='color:#004a43; '>endstruc</span>

<span style='color:#004a43; '>%define</span><span style='color:#004a43; '> t   eax</span>

<span style='color:#004a43; '>%define</span><span style='color:#004a43; '> a   ebx</span>
<span style='color:#004a43; '>%define</span><span style='color:#004a43; '> b   ecx</span>
<span style='color:#004a43; '>%define</span><span style='color:#004a43; '> c   edx</span>
<span style='color:#004a43; '>%define</span><span style='color:#004a43; '> d   esi</span>
<span style='color:#004a43; '>%define</span><span style='color:#004a43; '> e   edi</span>

<span style='color:#004a43; '>%define</span><span style='color:#004a43; '> G   ebp</span>

<span style='color:#e34adc; '>belt:</span>
<span style='color:#e34adc; '>_belt:</span>
    <span style='color:#800000; font-weight:bold; '>pushad</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>    <span style='color:#000080; '>edi</span><span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span><span style='color:#000080; '>esp</span><span style='color:#808030; '>+</span><span style='color:#008c00; '>32</span><span style='color:#008c00; '>+4</span><span style='color:#808030; '>]</span>   <span style='color:#696969; '>; k = mk</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>    <span style='color:#000080; '>esi</span><span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span><span style='color:#000080; '>esp</span><span style='color:#808030; '>+</span><span style='color:#008c00; '>32</span><span style='color:#008c00; '>+8</span><span style='color:#808030; '>]</span>   <span style='color:#696969; '>; x = data</span>
    <span style='color:#800000; font-weight:bold; '>xor</span>    <span style='color:#000080; '>eax</span><span style='color:#808030; '>,</span> <span style='color:#000080; '>eax</span>
    
    <span style='color:#800000; font-weight:bold; '>push</span>   <span style='color:#000080; '>esi</span>               <span style='color:#696969; '>; save x</span>
    <span style='color:#800000; font-weight:bold; '>push</span>   <span style='color:#000080; '>eax</span>               <span style='color:#696969; '>; save j</span>
    <span style='color:#800000; font-weight:bold; '>push</span>   <span style='color:#000080; '>edi</span>               <span style='color:#696969; '>; save k</span>
    <span style='color:#800000; font-weight:bold; '>push</span>   <span style='color:#000080; '>eax</span>               <span style='color:#696969; '>; save i</span>
    
    <span style='color:#800000; font-weight:bold; '>lodsd</span>
    <span style='color:#800000; font-weight:bold; '>xchg</span>   a<span style='color:#808030; '>,</span> <span style='color:#000080; '>eax</span>            <span style='color:#696969; '>; a = x[0]</span>
    <span style='color:#800000; font-weight:bold; '>lodsd</span>
    <span style='color:#800000; font-weight:bold; '>xchg</span>   b<span style='color:#808030; '>,</span> <span style='color:#000080; '>eax</span>            <span style='color:#696969; '>; b = x[1]</span>
    <span style='color:#800000; font-weight:bold; '>lodsd</span>
    <span style='color:#800000; font-weight:bold; '>xchg</span>   <span style='color:#004a43; '>c</span><span style='color:#808030; '>,</span> <span style='color:#000080; '>eax</span>            <span style='color:#696969; '>; c = x[2]</span>
    <span style='color:#800000; font-weight:bold; '>lodsd</span>
    <span style='color:#800000; font-weight:bold; '>xchg</span>   d<span style='color:#808030; '>,</span> <span style='color:#000080; '>eax</span>            <span style='color:#696969; '>; d = x[3]</span>
    <span style='color:#800000; font-weight:bold; '>call</span>   <span style='color:#e34adc; '>b_L0</span>
    <span style='color:#696969; '>; ------------------------</span>
    <span style='color:#696969; '>; G function</span>
    <span style='color:#696969; '>; ------------------------</span>
    <span style='color:#800000; font-weight:bold; '>pushad</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>    <span style='color:#000080; '>esi</span><span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span><span style='color:#000080; '>esp</span><span style='color:#808030; '>+</span>_esp<span style='color:#808030; '>]</span>   <span style='color:#696969; '>; esi=esp</span>
    <span style='color:#800000; font-weight:bold; '>lodsd</span>                    <span style='color:#696969; '>; eax=return address</span>
    <span style='color:#800000; font-weight:bold; '>lodsd</span>                    <span style='color:#696969; '>; edx=x</span>
    <span style='color:#800000; font-weight:bold; '>xchg</span>   <span style='color:#000080; '>eax</span><span style='color:#808030; '>,</span> <span style='color:#000080; '>edx</span>          <span style='color:#696969; '>; </span>
    <span style='color:#800000; font-weight:bold; '>lodsd</span>                    <span style='color:#696969; '>; eax=r</span>
    <span style='color:#800000; font-weight:bold; '>push</span>   <span style='color:#000080; '>eax</span>               <span style='color:#696969; '>; save r</span>
    <span style='color:#800000; font-weight:bold; '>lodsd</span>                    <span style='color:#696969; '>; eax=i</span>
    <span style='color:#800000; font-weight:bold; '>lodsd</span>                    <span style='color:#696969; '>; eax=k</span>
    <span style='color:#800000; font-weight:bold; '>xchg</span>   <span style='color:#000080; '>eax</span><span style='color:#808030; '>,</span> <span style='color:#000080; '>edi</span>          <span style='color:#696969; '>; edi=k</span>
    <span style='color:#800000; font-weight:bold; '>lodsd</span>                    <span style='color:#696969; '>; eax=j</span>
    <span style='color:#800000; font-weight:bold; '>inc</span>    <span style='color:#800000; font-weight:bold; '>dword</span><span style='color:#808030; '>[</span><span style='color:#000080; '>esi</span><span style='color:#808030; '>-</span><span style='color:#008c00; '>4</span><span style='color:#808030; '>]</span>      <span style='color:#696969; '>; j++</span>
    <span style='color:#800000; font-weight:bold; '>and</span>    <span style='color:#000080; '>eax</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>7</span>            <span style='color:#696969; '>; j &amp;= 7</span>
    <span style='color:#800000; font-weight:bold; '>add</span>    <span style='color:#000080; '>edx</span><span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span><span style='color:#000080; '>edi</span><span style='color:#808030; '>+</span><span style='color:#000080; '>eax</span><span style='color:#808030; '>*</span><span style='color:#008c00; '>4</span><span style='color:#808030; '>]</span>  <span style='color:#696969; '>; x += k[j&amp;7]</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>    <span style='color:#000080; '>al</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>4</span>
<span style='color:#e34adc; '>g_H0:</span>
    <span style='color:#696969; '>; if (x==10) return 0;</span>
    <span style='color:#800000; font-weight:bold; '>sub</span>    <span style='color:#000080; '>dl</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>10</span>
    <span style='color:#800000; font-weight:bold; '>jz</span>     <span style='color:#e34adc; '>g_H3</span>
    <span style='color:#696969; '>; if (x&lt;10) x++;</span>
    <span style='color:#800000; font-weight:bold; '>adc</span>    <span style='color:#000080; '>dl</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>10</span>
    <span style='color:#800000; font-weight:bold; '>movzx</span>  <span style='color:#000080; '>ecx</span><span style='color:#808030; '>,</span> <span style='color:#000080; '>dl</span>
    <span style='color:#696969; '>; t = 0x1d;</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>    <span style='color:#000080; '>dl</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x1d</span>
<span style='color:#e34adc; '>g_H1:</span>
    <span style='color:#800000; font-weight:bold; '>push</span>   <span style='color:#000080; '>ecx</span>
    <span style='color:#696969; '>; j = 116;</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>    <span style='color:#000080; '>cl</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>116</span>
<span style='color:#e34adc; '>g_H2:</span>
    <span style='color:#696969; '>; w = t &amp; 99;</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>    <span style='color:#000080; '>bl</span><span style='color:#808030; '>,</span> <span style='color:#000080; '>dl</span>
    <span style='color:#800000; font-weight:bold; '>and</span>    <span style='color:#000080; '>bl</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>99</span>
    <span style='color:#696969; '>; w ^= (w >> 1)</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>    <span style='color:#000080; '>bh</span><span style='color:#808030; '>,</span> <span style='color:#000080; '>bl</span>
    <span style='color:#800000; font-weight:bold; '>shr</span>    <span style='color:#000080; '>bh</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span>
    <span style='color:#800000; font-weight:bold; '>xor</span>    <span style='color:#000080; '>bl</span><span style='color:#808030; '>,</span> <span style='color:#000080; '>bh</span>
    <span style='color:#696969; '>; w ^= (w >> 2)</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>    <span style='color:#000080; '>bh</span><span style='color:#808030; '>,</span> <span style='color:#000080; '>bl</span>
    <span style='color:#800000; font-weight:bold; '>shr</span>    <span style='color:#000080; '>bh</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>2</span>
    <span style='color:#800000; font-weight:bold; '>xor</span>    <span style='color:#000080; '>bl</span><span style='color:#808030; '>,</span> <span style='color:#000080; '>bh</span>
    <span style='color:#696969; '>; w ^= (w >> 4)</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>    <span style='color:#000080; '>bh</span><span style='color:#808030; '>,</span> <span style='color:#000080; '>bl</span>
    <span style='color:#800000; font-weight:bold; '>shr</span>    <span style='color:#000080; '>bh</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>4</span>
    <span style='color:#800000; font-weight:bold; '>xor</span>    <span style='color:#000080; '>bl</span><span style='color:#808030; '>,</span> <span style='color:#000080; '>bh</span>
    <span style='color:#696969; '>; t = t >> 1 | w &lt;&lt; 7</span>
    <span style='color:#800000; font-weight:bold; '>shl</span>    <span style='color:#000080; '>bl</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>7</span>
    <span style='color:#800000; font-weight:bold; '>shr</span>    <span style='color:#000080; '>dl</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span>
    <span style='color:#800000; font-weight:bold; '>or</span>     <span style='color:#000080; '>dl</span><span style='color:#808030; '>,</span> <span style='color:#000080; '>bl</span>
    <span style='color:#800000; font-weight:bold; '>loop</span>   <span style='color:#e34adc; '>g_H2</span>
    <span style='color:#800000; font-weight:bold; '>pop</span>    <span style='color:#000080; '>ecx</span>
    <span style='color:#800000; font-weight:bold; '>loop</span>   <span style='color:#e34adc; '>g_H1</span>
<span style='color:#e34adc; '>g_H3:</span>
    <span style='color:#800000; font-weight:bold; '>ror</span>    <span style='color:#000080; '>edx</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>8</span>     <span style='color:#696969; '>; u.w = ROTR(u.w, 8)</span>
    <span style='color:#800000; font-weight:bold; '>dec</span>    <span style='color:#000080; '>eax</span>
    <span style='color:#800000; font-weight:bold; '>jnz</span>    <span style='color:#e34adc; '>g_H0</span>
    
    <span style='color:#800000; font-weight:bold; '>pop</span>    <span style='color:#000080; '>ecx</span>        <span style='color:#696969; '>; ecx=r</span>
    <span style='color:#800000; font-weight:bold; '>rol</span>    <span style='color:#000080; '>edx</span><span style='color:#808030; '>,</span> <span style='color:#000080; '>cl</span>    <span style='color:#696969; '>; return ROTL32(u.w, r);</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>    <span style='color:#808030; '>[</span><span style='color:#000080; '>esp</span><span style='color:#808030; '>+</span>_eax<span style='color:#808030; '>]</span><span style='color:#808030; '>,</span> <span style='color:#000080; '>edx</span>
    <span style='color:#800000; font-weight:bold; '>popad</span>
    <span style='color:#800000; font-weight:bold; '>retn</span>   <span style='color:#008c00; '>2</span><span style='color:#808030; '>*</span><span style='color:#008c00; '>4</span>
    <span style='color:#696969; '>; -----------------------</span>
<span style='color:#e34adc; '>b_L0:</span>    
    <span style='color:#800000; font-weight:bold; '>pop</span>    G
<span style='color:#e34adc; '>b_L1:</span>
    <span style='color:#800000; font-weight:bold; '>push</span>   <span style='color:#008c00; '>5</span>
    <span style='color:#800000; font-weight:bold; '>push</span>   a
    <span style='color:#800000; font-weight:bold; '>call</span>   <span style='color:#e34adc; '>G</span>   
    <span style='color:#800000; font-weight:bold; '>xor</span>    b<span style='color:#808030; '>,</span> t       <span style='color:#696969; '>; b ^= G(a, k, j+0, 5);</span>
    
    <span style='color:#800000; font-weight:bold; '>push</span>   <span style='color:#008c00; '>21</span>
    <span style='color:#800000; font-weight:bold; '>push</span>   d
    <span style='color:#800000; font-weight:bold; '>call</span>   <span style='color:#e34adc; '>G</span>     
    <span style='color:#800000; font-weight:bold; '>xor</span>    <span style='color:#004a43; '>c</span><span style='color:#808030; '>,</span> t       <span style='color:#696969; '>; c ^= G(d, k, j+1,21);</span>
    
    <span style='color:#800000; font-weight:bold; '>push</span>   <span style='color:#008c00; '>13</span>
    <span style='color:#800000; font-weight:bold; '>push</span>   b
    <span style='color:#800000; font-weight:bold; '>call</span>   <span style='color:#e34adc; '>G</span>       
    <span style='color:#800000; font-weight:bold; '>sub</span>    a<span style='color:#808030; '>,</span> t       <span style='color:#696969; '>; a -= G(b, k, j+2,13);</span>
    
    <span style='color:#800000; font-weight:bold; '>push</span>   <span style='color:#008c00; '>21</span>
    <span style='color:#800000; font-weight:bold; '>lea</span>    t<span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span>b <span style='color:#808030; '>+</span> <span style='color:#004a43; '>c</span><span style='color:#808030; '>]</span>
    <span style='color:#800000; font-weight:bold; '>push</span>   t
    <span style='color:#800000; font-weight:bold; '>call</span>   <span style='color:#e34adc; '>G</span>          <span style='color:#696969; '>; e  = G(b + c, k, j+3,21);</span>
    <span style='color:#800000; font-weight:bold; '>xchg</span>   t<span style='color:#808030; '>,</span> e
    
    <span style='color:#800000; font-weight:bold; '>pop</span>    t          <span style='color:#696969; '>; t = i</span>
    <span style='color:#800000; font-weight:bold; '>inc</span>    t          <span style='color:#696969; '>; i++</span>
    <span style='color:#800000; font-weight:bold; '>push</span>   t          <span style='color:#696969; '>; save i</span>
    
    <span style='color:#800000; font-weight:bold; '>xor</span>    e<span style='color:#808030; '>,</span> t       <span style='color:#696969; '>; e ^= i;</span>
    <span style='color:#800000; font-weight:bold; '>add</span>    b<span style='color:#808030; '>,</span> e       <span style='color:#696969; '>; b += e;</span>
    <span style='color:#800000; font-weight:bold; '>sub</span>    <span style='color:#004a43; '>c</span><span style='color:#808030; '>,</span> e       <span style='color:#696969; '>; c -= e;</span>
    
    <span style='color:#800000; font-weight:bold; '>push</span>   <span style='color:#008c00; '>13</span>
    <span style='color:#800000; font-weight:bold; '>push</span>   <span style='color:#004a43; '>c</span>
    <span style='color:#800000; font-weight:bold; '>call</span>   <span style='color:#e34adc; '>G</span>
    <span style='color:#800000; font-weight:bold; '>add</span>    d<span style='color:#808030; '>,</span> t       <span style='color:#696969; '>; d += G(c, k, j+4,13);</span>
    
    <span style='color:#800000; font-weight:bold; '>push</span>   <span style='color:#008c00; '>21</span>
    <span style='color:#800000; font-weight:bold; '>push</span>   a
    <span style='color:#800000; font-weight:bold; '>call</span>   <span style='color:#e34adc; '>G</span>
    <span style='color:#800000; font-weight:bold; '>xor</span>    b<span style='color:#808030; '>,</span> t       <span style='color:#696969; '>; b ^= G(a, k, j+5,21);</span>
    
    <span style='color:#800000; font-weight:bold; '>push</span>   <span style='color:#008c00; '>5</span>
    <span style='color:#800000; font-weight:bold; '>push</span>   d
    <span style='color:#800000; font-weight:bold; '>call</span>   <span style='color:#e34adc; '>G</span>
    <span style='color:#800000; font-weight:bold; '>xor</span>    <span style='color:#004a43; '>c</span><span style='color:#808030; '>,</span> t       <span style='color:#696969; '>; c ^= G(d, k, j+6, 5);</span>
    
    <span style='color:#800000; font-weight:bold; '>xchg</span>   a<span style='color:#808030; '>,</span> b
    <span style='color:#800000; font-weight:bold; '>xchg</span>   <span style='color:#004a43; '>c</span><span style='color:#808030; '>,</span> d
    <span style='color:#800000; font-weight:bold; '>xchg</span>   b<span style='color:#808030; '>,</span> <span style='color:#004a43; '>c</span>
    
    <span style='color:#800000; font-weight:bold; '>pop</span>    <span style='color:#000080; '>eax</span>
    <span style='color:#800000; font-weight:bold; '>push</span>   <span style='color:#000080; '>eax</span>
    <span style='color:#800000; font-weight:bold; '>cmp</span>    <span style='color:#000080; '>al</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>8</span>
    <span style='color:#800000; font-weight:bold; '>jnz</span>    <span style='color:#e34adc; '>b_L1</span>
    
    <span style='color:#800000; font-weight:bold; '>pop</span>    <span style='color:#000080; '>eax</span>       <span style='color:#696969; '>; remove i</span>
    <span style='color:#800000; font-weight:bold; '>pop</span>    <span style='color:#000080; '>eax</span>       <span style='color:#696969; '>; remove k</span>
    <span style='color:#800000; font-weight:bold; '>pop</span>    <span style='color:#000080; '>eax</span>       <span style='color:#696969; '>; remove j</span>
    <span style='color:#800000; font-weight:bold; '>pop</span>    <span style='color:#000080; '>edi</span>       <span style='color:#696969; '>; restore x</span>

    <span style='color:#800000; font-weight:bold; '>xchg</span>   <span style='color:#000080; '>eax</span><span style='color:#808030; '>,</span> b
    <span style='color:#800000; font-weight:bold; '>stosd</span>            <span style='color:#696969; '>; x[0] = b</span>
    <span style='color:#800000; font-weight:bold; '>xchg</span>   <span style='color:#000080; '>eax</span><span style='color:#808030; '>,</span> d
    <span style='color:#800000; font-weight:bold; '>stosd</span>            <span style='color:#696969; '>; x[1] = d</span>
    <span style='color:#800000; font-weight:bold; '>xchg</span>   <span style='color:#000080; '>eax</span><span style='color:#808030; '>,</span> a
    <span style='color:#800000; font-weight:bold; '>stosd</span>            <span style='color:#696969; '>; x[2] = a</span>
    <span style='color:#800000; font-weight:bold; '>xchg</span>   <span style='color:#000080; '>eax</span><span style='color:#808030; '>,</span> <span style='color:#004a43; '>c</span>
    <span style='color:#800000; font-weight:bold; '>stosd</span>            <span style='color:#696969; '>; x[3] = c</span>
    <span style='color:#800000; font-weight:bold; '>popad</span>            <span style='color:#696969; '>; restore registers</span>
    <span style='color:#800000; font-weight:bold; '>ret</span>
    
</pre>

<h3><strong>Summary</strong></h3>

<p><a href="https://github.com/odzhan/tinycrypt/tree/master/block/belt">Sources here</a>.</p>
