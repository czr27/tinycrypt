<h3><strong>Introduction</strong></h3>

<p>SHACAL-1 and <a href="https://github.com/odzhan/tinycrypt/blob/master/block/shacal2/doc/10.1.1.3.4066.pdf">SHACAL-2</a> are block ciphers based on the Secure Hash Standard. They were proposed by <a href="https://lirias.kuleuven.be/cv?u=U0063140">Helena Handschuh</a> and <a href="https://www.ens-paris.fr/index.php?id=4">David Naccache</a> while both working for the now defunct smartcard company, Gemplus International. SHACAL-1 is an 80 round block cipher built atop of the SHA-1 compression function. It supports a 160-bit block with key sizes of between 128 and 512-bits. SHACAL-2 is a 64 round block cipher built atop of the SHA-256 compression function and supports a larger 256-bit block. Both were submitted to the <a href="https://www.cosic.esat.kuleuven.be/nessie/">New European Schemes for Signatures, Integrity and Encryption</a> (NESSIE) project. SHACAL-1 was dropped from the portfolio in 2003 due to concerns about its key schedule, but SHACAL-2 was finally selected. The best known attack against SHACAL-2 is <a href="https://dl.acm.org/citation.cfm?id=1522105">a related-key rectangle attack</a> on round 44 of the 64 rounds in total.</p>

<h3><strong>Macros and data types</strong></h3>

<pre style='color:#000000;background:#ffffff;'><span style='color:#004a43; '>#</span><span style='color:#004a43; '>define</span><span style='color:#004a43; '> R</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>v</span><span style='color:#808030; '>,</span><span style='color:#004a43; '>n</span><span style='color:#808030; '>)</span><span style='color:#808030; '>(</span><span style='color:#808030; '>(</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>v</span><span style='color:#808030; '>)</span><span style='color:#808030; '>></span><span style='color:#808030; '>></span><span style='color:#808030; '>(</span><span style='color:#004a43; '>n</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>|</span><span style='color:#808030; '>(</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>v</span><span style='color:#808030; '>)</span><span style='color:#808030; '>&lt;</span><span style='color:#808030; '>&lt;</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>32</span><span style='color:#808030; '>-</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>n</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span>
<span style='color:#004a43; '>#</span><span style='color:#004a43; '>define</span><span style='color:#004a43; '> F</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>n</span><span style='color:#808030; '>)</span><span style='color:#004a43; '>for</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>i</span><span style='color:#808030; '>=</span><span style='color:#004a43; '>0</span><span style='color:#808030; '>;</span><span style='color:#004a43; '>i</span><span style='color:#808030; '>&lt;</span><span style='color:#004a43; '>n</span><span style='color:#808030; '>;</span><span style='color:#004a43; '>i</span><span style='color:#808030; '>+</span><span style='color:#808030; '>+</span><span style='color:#808030; '>)</span>

<span style='color:#004a43; '>#</span><span style='color:#004a43; '>define</span><span style='color:#004a43; '> rev32</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>x</span><span style='color:#808030; '>)</span><span style='color:#004a43; '> __builtin_bswap32</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>x</span><span style='color:#808030; '>)</span>

<span style='color:#800000; font-weight:bold; '>typedef</span> <span style='color:#800000; font-weight:bold; '>unsigned</span> <span style='color:#800000; font-weight:bold; '>long</span> <span style='color:#800000; font-weight:bold; '>long</span> Q<span style='color:#800080; '>;</span>
<span style='color:#800000; font-weight:bold; '>typedef</span> <span style='color:#800000; font-weight:bold; '>unsigned</span> <span style='color:#800000; font-weight:bold; '>int</span> W<span style='color:#800080; '>;</span>
<span style='color:#800000; font-weight:bold; '>typedef</span> <span style='color:#800000; font-weight:bold; '>unsigned</span> <span style='color:#800000; font-weight:bold; '>char</span> B<span style='color:#800080; '>;</span>

<span style='color:#800000; font-weight:bold; '>typedef</span> <span style='color:#800000; font-weight:bold; '>struct</span> _sha256_ctx <span style='color:#800080; '>{</span>
    W s<span style='color:#808030; '>[</span><span style='color:#008c00; '>8</span><span style='color:#808030; '>]</span><span style='color:#800080; '>;</span>
    <span style='color:#800000; font-weight:bold; '>union</span> <span style='color:#800080; '>{</span>
      B b<span style='color:#808030; '>[</span><span style='color:#008c00; '>64</span><span style='color:#808030; '>]</span><span style='color:#800080; '>;</span>
      W w<span style='color:#808030; '>[</span><span style='color:#008c00; '>16</span><span style='color:#808030; '>]</span><span style='color:#800080; '>;</span>
      Q q<span style='color:#808030; '>[</span><span style='color:#008c00; '>8</span><span style='color:#808030; '>]</span><span style='color:#800080; '>;</span>
    <span style='color:#800080; '>}</span>x<span style='color:#800080; '>;</span>
    Q len<span style='color:#800080; '>;</span>
<span style='color:#800080; '>}</span>sha256_ctx<span style='color:#800080; '>;</span>
</pre>

<h3><strong>Compact code</strong></h3>

<p>The following is not optimized for performance. It's a simplified version intended to be used as a reference. The <var>mk</var> parameter should point to a key between 128 and 512-bits while <var>data</var> should point to a 256-bit block of plaintext to encrypt.</p>

<pre style='color:#000000;background:#ffffff;'><span style='color:#004a43; '>#</span><span style='color:#004a43; '>define</span><span style='color:#004a43; '> CH</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>x</span><span style='color:#808030; '>,</span><span style='color:#004a43; '>y</span><span style='color:#808030; '>,</span><span style='color:#004a43; '>z</span><span style='color:#808030; '>)</span><span style='color:#808030; '>(</span><span style='color:#808030; '>(</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>x</span><span style='color:#808030; '>)</span><span style='color:#808030; '>&amp;</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>y</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>^</span><span style='color:#808030; '>(</span><span style='color:#808030; '>~</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>x</span><span style='color:#808030; '>)</span><span style='color:#808030; '>&amp;</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>z</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span>
<span style='color:#004a43; '>#</span><span style='color:#004a43; '>define</span><span style='color:#004a43; '> MAJ</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>x</span><span style='color:#808030; '>,</span><span style='color:#004a43; '>y</span><span style='color:#808030; '>,</span><span style='color:#004a43; '>z</span><span style='color:#808030; '>)</span><span style='color:#808030; '>(</span><span style='color:#808030; '>(</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>x</span><span style='color:#808030; '>)</span><span style='color:#808030; '>&amp;</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>y</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>^</span><span style='color:#808030; '>(</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>x</span><span style='color:#808030; '>)</span><span style='color:#808030; '>&amp;</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>z</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>^</span><span style='color:#808030; '>(</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>y</span><span style='color:#808030; '>)</span><span style='color:#808030; '>&amp;</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>z</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span>
<span style='color:#004a43; '>#</span><span style='color:#004a43; '>define</span><span style='color:#004a43; '> EP0</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>x</span><span style='color:#808030; '>)</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>R</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>x</span><span style='color:#808030; '>,</span><span style='color:#004a43; '>2</span><span style='color:#808030; '>)</span><span style='color:#808030; '>^</span><span style='color:#004a43; '>R</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>x</span><span style='color:#808030; '>,</span><span style='color:#004a43; '>13</span><span style='color:#808030; '>)</span><span style='color:#808030; '>^</span><span style='color:#004a43; '>R</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>x</span><span style='color:#808030; '>,</span><span style='color:#004a43; '>22</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span>
<span style='color:#004a43; '>#</span><span style='color:#004a43; '>define</span><span style='color:#004a43; '> EP1</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>x</span><span style='color:#808030; '>)</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>R</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>x</span><span style='color:#808030; '>,</span><span style='color:#004a43; '>6</span><span style='color:#808030; '>)</span><span style='color:#808030; '>^</span><span style='color:#004a43; '>R</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>x</span><span style='color:#808030; '>,</span><span style='color:#004a43; '>11</span><span style='color:#808030; '>)</span><span style='color:#808030; '>^</span><span style='color:#004a43; '>R</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>x</span><span style='color:#808030; '>,</span><span style='color:#004a43; '>25</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span>
<span style='color:#004a43; '>#</span><span style='color:#004a43; '>define</span><span style='color:#004a43; '> SIG0</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>x</span><span style='color:#808030; '>)</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>R</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>x</span><span style='color:#808030; '>,</span><span style='color:#004a43; '>7</span><span style='color:#808030; '>)</span><span style='color:#808030; '>^</span><span style='color:#004a43; '>R</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>x</span><span style='color:#808030; '>,</span><span style='color:#004a43; '>18</span><span style='color:#808030; '>)</span><span style='color:#808030; '>^</span><span style='color:#808030; '>(</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>x</span><span style='color:#808030; '>)</span><span style='color:#808030; '>></span><span style='color:#808030; '>></span><span style='color:#004a43; '>3</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span>
<span style='color:#004a43; '>#</span><span style='color:#004a43; '>define</span><span style='color:#004a43; '> SIG1</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>x</span><span style='color:#808030; '>)</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>R</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>x</span><span style='color:#808030; '>,</span><span style='color:#004a43; '>17</span><span style='color:#808030; '>)</span><span style='color:#808030; '>^</span><span style='color:#004a43; '>R</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>x</span><span style='color:#808030; '>,</span><span style='color:#004a43; '>19</span><span style='color:#808030; '>)</span><span style='color:#808030; '>^</span><span style='color:#808030; '>(</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>x</span><span style='color:#808030; '>)</span><span style='color:#808030; '>></span><span style='color:#808030; '>></span><span style='color:#004a43; '>10</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span>

<span style='color:#800000; font-weight:bold; '>void</span> shacal2<span style='color:#808030; '>(</span><span style='color:#800000; font-weight:bold; '>void</span><span style='color:#808030; '>*</span>mk<span style='color:#808030; '>,</span><span style='color:#800000; font-weight:bold; '>void</span><span style='color:#808030; '>*</span>data<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
    W t1<span style='color:#808030; '>,</span>t2<span style='color:#808030; '>,</span>i<span style='color:#808030; '>,</span>w<span style='color:#808030; '>[</span><span style='color:#008c00; '>64</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span>s<span style='color:#808030; '>[</span><span style='color:#008c00; '>8</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span><span style='color:#808030; '>*</span>k<span style='color:#808030; '>=</span>mk<span style='color:#808030; '>,</span><span style='color:#808030; '>*</span>x<span style='color:#808030; '>=</span>data<span style='color:#800080; '>;</span>
    
    W K<span style='color:#808030; '>[</span><span style='color:#008c00; '>64</span><span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>
    <span style='color:#800080; '>{</span> <span style='color:#008000; '>0x428a2f98</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x71374491</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xb5c0fbcf</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xe9b5dba5</span><span style='color:#808030; '>,</span> 
      <span style='color:#008000; '>0x3956c25b</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x59f111f1</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x923f82a4</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xab1c5ed5</span><span style='color:#808030; '>,</span>
      <span style='color:#008000; '>0xd807aa98</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x12835b01</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x243185be</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x550c7dc3</span><span style='color:#808030; '>,</span> 
      <span style='color:#008000; '>0x72be5d74</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x80deb1fe</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x9bdc06a7</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xc19bf174</span><span style='color:#808030; '>,</span>
      <span style='color:#008000; '>0xe49b69c1</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xefbe4786</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x0fc19dc6</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x240ca1cc</span><span style='color:#808030; '>,</span> 
      <span style='color:#008000; '>0x2de92c6f</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x4a7484aa</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x5cb0a9dc</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x76f988da</span><span style='color:#808030; '>,</span>
      <span style='color:#008000; '>0x983e5152</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xa831c66d</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xb00327c8</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xbf597fc7</span><span style='color:#808030; '>,</span> 
      <span style='color:#008000; '>0xc6e00bf3</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xd5a79147</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x06ca6351</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x14292967</span><span style='color:#808030; '>,</span>
      <span style='color:#008000; '>0x27b70a85</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x2e1b2138</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x4d2c6dfc</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x53380d13</span><span style='color:#808030; '>,</span> 
      <span style='color:#008000; '>0x650a7354</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x766a0abb</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x81c2c92e</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x92722c85</span><span style='color:#808030; '>,</span>
      <span style='color:#008000; '>0xa2bfe8a1</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xa81a664b</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xc24b8b70</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xc76c51a3</span><span style='color:#808030; '>,</span> 
      <span style='color:#008000; '>0xd192e819</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xd6990624</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xf40e3585</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x106aa070</span><span style='color:#808030; '>,</span>
      <span style='color:#008000; '>0x19a4c116</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x1e376c08</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x2748774c</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x34b0bcb5</span><span style='color:#808030; '>,</span> 
      <span style='color:#008000; '>0x391c0cb3</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x4ed8aa4a</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x5b9cca4f</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x682e6ff3</span><span style='color:#808030; '>,</span>
      <span style='color:#008000; '>0x748f82ee</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x78a5636f</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x84c87814</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x8cc70208</span><span style='color:#808030; '>,</span> 
      <span style='color:#008000; '>0x90befffa</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xa4506ceb</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xbef9a3f7</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0xc67178f2</span> <span style='color:#800080; '>}</span><span style='color:#800080; '>;</span> 
    
    <span style='color:#696969; '>// load master key</span>
    F<span style='color:#808030; '>(</span><span style='color:#008c00; '>16</span><span style='color:#808030; '>)</span>w<span style='color:#808030; '>[</span>i<span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>rev32<span style='color:#808030; '>(</span>k<span style='color:#808030; '>[</span>i<span style='color:#808030; '>]</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
    <span style='color:#696969; '>// expand key</span>
    <span style='color:#800000; font-weight:bold; '>for</span><span style='color:#808030; '>(</span>i<span style='color:#808030; '>=</span><span style='color:#008c00; '>16</span><span style='color:#800080; '>;</span>i<span style='color:#808030; '>&lt;</span><span style='color:#008c00; '>64</span><span style='color:#800080; '>;</span>i<span style='color:#808030; '>+</span><span style='color:#808030; '>+</span><span style='color:#808030; '>)</span>
      w<span style='color:#808030; '>[</span>i<span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>SIG1<span style='color:#808030; '>(</span>w<span style='color:#808030; '>[</span>i<span style='color:#808030; '>-</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>]</span><span style='color:#808030; '>)</span><span style='color:#808030; '>+</span>w<span style='color:#808030; '>[</span>i<span style='color:#808030; '>-</span><span style='color:#008c00; '>7</span><span style='color:#808030; '>]</span><span style='color:#808030; '>+</span>SIG0<span style='color:#808030; '>(</span>w<span style='color:#808030; '>[</span>i<span style='color:#808030; '>-</span><span style='color:#008c00; '>15</span><span style='color:#808030; '>]</span><span style='color:#808030; '>)</span><span style='color:#808030; '>+</span>w<span style='color:#808030; '>[</span>i<span style='color:#808030; '>-</span><span style='color:#008c00; '>16</span><span style='color:#808030; '>]</span><span style='color:#800080; '>;</span>
    <span style='color:#696969; '>// load 256-bit plaintext</span>
    F<span style='color:#808030; '>(</span><span style='color:#008c00; '>8</span><span style='color:#808030; '>)</span>s<span style='color:#808030; '>[</span>i<span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>rev32<span style='color:#808030; '>(</span>x<span style='color:#808030; '>[</span>i<span style='color:#808030; '>]</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
    <span style='color:#696969; '>// encrypt</span>
    F<span style='color:#808030; '>(</span><span style='color:#008c00; '>64</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
      t1<span style='color:#808030; '>=</span>s<span style='color:#808030; '>[</span><span style='color:#008c00; '>7</span><span style='color:#808030; '>]</span><span style='color:#808030; '>+</span>EP1<span style='color:#808030; '>(</span>s<span style='color:#808030; '>[</span><span style='color:#008c00; '>4</span><span style='color:#808030; '>]</span><span style='color:#808030; '>)</span><span style='color:#808030; '>+</span>CH<span style='color:#808030; '>(</span>s<span style='color:#808030; '>[</span><span style='color:#008c00; '>4</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span>s<span style='color:#808030; '>[</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span>s<span style='color:#808030; '>[</span><span style='color:#008c00; '>6</span><span style='color:#808030; '>]</span><span style='color:#808030; '>)</span><span style='color:#808030; '>+</span>w<span style='color:#808030; '>[</span>i<span style='color:#808030; '>]</span><span style='color:#808030; '>+</span>K<span style='color:#808030; '>[</span>i<span style='color:#808030; '>]</span><span style='color:#800080; '>;</span>
      t2<span style='color:#808030; '>=</span>EP0<span style='color:#808030; '>(</span>s<span style='color:#808030; '>[</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>]</span><span style='color:#808030; '>)</span><span style='color:#808030; '>+</span>MAJ<span style='color:#808030; '>(</span>s<span style='color:#808030; '>[</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span>s<span style='color:#808030; '>[</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span>s<span style='color:#808030; '>[</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>]</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
      s<span style='color:#808030; '>[</span><span style='color:#008c00; '>7</span><span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>s<span style='color:#808030; '>[</span><span style='color:#008c00; '>6</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span>s<span style='color:#808030; '>[</span><span style='color:#008c00; '>6</span><span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>s<span style='color:#808030; '>[</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span>s<span style='color:#808030; '>[</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>s<span style='color:#808030; '>[</span><span style='color:#008c00; '>4</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span>s<span style='color:#808030; '>[</span><span style='color:#008c00; '>4</span><span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>s<span style='color:#808030; '>[</span><span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span><span style='color:#808030; '>+</span>t1<span style='color:#800080; '>;</span>
      s<span style='color:#808030; '>[</span><span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>s<span style='color:#808030; '>[</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span>s<span style='color:#808030; '>[</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>s<span style='color:#808030; '>[</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span>s<span style='color:#808030; '>[</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>s<span style='color:#808030; '>[</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span>s<span style='color:#808030; '>[</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>t1<span style='color:#808030; '>+</span>t2<span style='color:#800080; '>;</span>
    <span style='color:#800080; '>}</span>
    <span style='color:#696969; '>// store 256-bit ciphertext</span>
    F<span style='color:#808030; '>(</span><span style='color:#008c00; '>8</span><span style='color:#808030; '>)</span>x<span style='color:#808030; '>[</span>i<span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>rev32<span style='color:#808030; '>(</span>s<span style='color:#808030; '>[</span>i<span style='color:#808030; '>]</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
<span style='color:#800080; '>}</span>
</pre>

<p><a href="https://github.com/odzhan/tinycrypt/tree/master/block/shacal2">Sources here.</a></p>
