
// test unit for chaskey
// odzhan

#include <stdio.h>
#include <string.h>
#include <stdint.h>

void chaskey(void *mk, void *data);

// 128-bit master key
uint8_t key[16] =
{ 0x56, 0x09, 0xe9, 0x68,
  0x5f, 0x58, 0xe3, 0x29,
  0x40, 0xec, 0xec, 0x98,
  0xc5, 0x22, 0x98, 0x2f };
  
// 128-bit plain text
uint8_t plain[16]=
{ 0xb8, 0x23, 0x28, 0x26,
  0xfd, 0x5e, 0x40, 0x5e,
  0x69, 0xa3, 0x01, 0xa9,
  0x78, 0xea, 0x7a, 0xd8 };

// 128-bit cipher text
uint8_t cipher[16] =
{	0xd5, 0x60, 0x8d, 0x4d, 
	0xa2, 0xbf, 0x34, 0x7b,
	0xab, 0xf8, 0x77, 0x2f, 
	0xdf, 0xed, 0xde, 0x07 };

int main(void) {
    uint8_t data[16];
    int     equ;
    
    memcpy(data, plain, 16);
    chaskey(key, data);
    equ = (memcmp(data, cipher, 16)==0);
    printf("CHASKEY test : %s\n", equ ? "OK" : "FAILED");
    return 0;
}
