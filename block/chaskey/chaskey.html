<h3><strong>Introduction</strong></h3>

<p><a href="http://mouha.be/chaskey/">Chaskey</a> is a 128-bit block cipher with support for 128-bit keys. It was designed by Nicky Mouha, Bart Mennink, Anthony Van Herrewege, Dai Watanabe, Bart Preneel and Ingrid Verbauwhede. The main permutation is derived from <a href="https://aumasson.jp/siphash/">SipHash</a>, a fast short-input Pseudo-Random-Function (PRF) designed and published in 2012 by <a href="https://cr.yp.to/djb.html">Daniel Bernstein</a> and <a href="https://aumasson.jp/">Jean-Phillippe Aumasson</a>. It uses an Even-Mansour construction. <strong><a href="http://www.wisdom.weizmann.ac.il/~oded/s_even.html">Shimon Even</a></strong> and <strong><a href="https://www.tau.ac.il/~mansour/">Yishay Mansour</a></strong> published a paper in 1997 titled A Construction of a Cipher From a Single Pseudorandom Permutation that suggested an incredibly simple but provably secure design for a cryptographic algorithm. Because only add-rotate-xor (ARX) instructions are used, it's very suitable for many architectures. </p>

<img src="https://tinycrypt.files.wordpress.com/2017/02/even_mansour.jpg" alt="even_mansour" width="640" height="206" class="aligncenter size-full wp-image-1819" />

<p>The key is mixed with plaintext before encryption and after the application of permutation function <var>F</var>.</p>

<h3><strong>F function</strong></h3>

<p>The permutation uses 16 rounds of ADD/ROL/XOR (ARX) instructions for encryption. Decryption of ciphertext is simply reversing the process with SUB/ROR/XOR.</p>

<img src="https://tinycrypt.files.wordpress.com/2017/02/perm.png" alt="perm" width="441" height="501" class="aligncenter size-full wp-image-1820" />

<h3><strong>Full function</strong></h3>

<p>This will perform encryption and decryption depending the <var>enc</var> parameter.</p>

<pre style='color:#000000;background:#ffffff;'><span style='color:#800000;font-weight:bold;'>void</span> chaskey<span style='color:#808030;'>(</span><span style='color:#800000;font-weight:bold;'>int</span> enc<span style='color:#808030;'>,</span> <span style='color:#800000;font-weight:bold;'>void</span> <span style='color:#808030;'>*</span>key<span style='color:#808030;'>,</span> <span style='color:#800000;font-weight:bold;'>void</span> <span style='color:#808030;'>*</span>buf<span style='color:#808030;'>)</span> 
<span style='color:#800080;'>{</span>
   <span style='color:#800000;font-weight:bold;'>int</span>      i<span style='color:#800080;'>;</span>
   uint32_t <span style='color:#808030;'>*</span>v<span style='color:#808030;'>=</span><span style='color:#808030;'>(</span>uint32_t<span style='color:#808030;'>*</span><span style='color:#808030;'>)</span>buf<span style='color:#800080;'>;</span>
   uint32_t <span style='color:#808030;'>*</span>k<span style='color:#808030;'>=</span><span style='color:#808030;'>(</span>uint32_t<span style='color:#808030;'>*</span><span style='color:#808030;'>)</span>key<span style='color:#800080;'>;</span>
   
   <span style='color:#696969;'>// pre-whiten</span>
   <span style='color:#800000;font-weight:bold;'>for</span> <span style='color:#808030;'>(</span>i<span style='color:#808030;'>=</span><span style='color:#008c00;'>0</span><span style='color:#800080;'>;</span> i<span style='color:#808030;'>&lt;</span><span style='color:#008c00;'>4</span><span style='color:#800080;'>;</span> i<span style='color:#808030;'>+</span><span style='color:#808030;'>+</span><span style='color:#808030;'>)</span> <span style='color:#800080;'>{</span>
     v<span style='color:#808030;'>[</span>i<span style='color:#808030;'>]</span> <span style='color:#808030;'>^</span><span style='color:#808030;'>=</span> k<span style='color:#808030;'>[</span>i<span style='color:#808030;'>]</span><span style='color:#800080;'>;</span>
   <span style='color:#800080;'>}</span>

   <span style='color:#696969;'>// apply permutation function</span>
   <span style='color:#800000;font-weight:bold;'>for</span> <span style='color:#808030;'>(</span>i<span style='color:#808030;'>=</span><span style='color:#008c00;'>0</span><span style='color:#800080;'>;</span> i<span style='color:#808030;'>&lt;</span><span style='color:#008c00;'>16</span><span style='color:#800080;'>;</span> i<span style='color:#808030;'>+</span><span style='color:#808030;'>+</span><span style='color:#808030;'>)</span> <span style='color:#800080;'>{</span>
     <span style='color:#800000;font-weight:bold;'>if</span> <span style='color:#808030;'>(</span>enc<span style='color:#808030;'>=</span><span style='color:#808030;'>=</span>CHASKEY_ENCRYPT<span style='color:#808030;'>)</span>
     <span style='color:#800080;'>{</span>
       v<span style='color:#808030;'>[</span><span style='color:#008c00;'>0</span><span style='color:#808030;'>]</span> <span style='color:#808030;'>+</span><span style='color:#808030;'>=</span> v<span style='color:#808030;'>[</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>]</span><span style='color:#800080;'>;</span> 
       v<span style='color:#808030;'>[</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>]</span><span style='color:#808030;'>=</span>ROTL32<span style='color:#808030;'>(</span>v<span style='color:#808030;'>[</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>]</span><span style='color:#808030;'>,</span> <span style='color:#008c00;'>5</span><span style='color:#808030;'>)</span><span style='color:#800080;'>;</span> 
       v<span style='color:#808030;'>[</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>]</span> <span style='color:#808030;'>^</span><span style='color:#808030;'>=</span> v<span style='color:#808030;'>[</span><span style='color:#008c00;'>0</span><span style='color:#808030;'>]</span><span style='color:#800080;'>;</span> 
       v<span style='color:#808030;'>[</span><span style='color:#008c00;'>0</span><span style='color:#808030;'>]</span><span style='color:#808030;'>=</span>ROTL32<span style='color:#808030;'>(</span>v<span style='color:#808030;'>[</span><span style='color:#008c00;'>0</span><span style='color:#808030;'>]</span><span style='color:#808030;'>,</span><span style='color:#008c00;'>16</span><span style='color:#808030;'>)</span><span style='color:#800080;'>;</span>       
       v<span style='color:#808030;'>[</span><span style='color:#008c00;'>2</span><span style='color:#808030;'>]</span> <span style='color:#808030;'>+</span><span style='color:#808030;'>=</span> v<span style='color:#808030;'>[</span><span style='color:#008c00;'>3</span><span style='color:#808030;'>]</span><span style='color:#800080;'>;</span> 
       v<span style='color:#808030;'>[</span><span style='color:#008c00;'>3</span><span style='color:#808030;'>]</span><span style='color:#808030;'>=</span>ROTL32<span style='color:#808030;'>(</span>v<span style='color:#808030;'>[</span><span style='color:#008c00;'>3</span><span style='color:#808030;'>]</span><span style='color:#808030;'>,</span> <span style='color:#008c00;'>8</span><span style='color:#808030;'>)</span><span style='color:#800080;'>;</span> 
       v<span style='color:#808030;'>[</span><span style='color:#008c00;'>3</span><span style='color:#808030;'>]</span> <span style='color:#808030;'>^</span><span style='color:#808030;'>=</span> v<span style='color:#808030;'>[</span><span style='color:#008c00;'>2</span><span style='color:#808030;'>]</span><span style='color:#800080;'>;</span>
       v<span style='color:#808030;'>[</span><span style='color:#008c00;'>0</span><span style='color:#808030;'>]</span> <span style='color:#808030;'>+</span><span style='color:#808030;'>=</span> v<span style='color:#808030;'>[</span><span style='color:#008c00;'>3</span><span style='color:#808030;'>]</span><span style='color:#800080;'>;</span> 
       v<span style='color:#808030;'>[</span><span style='color:#008c00;'>3</span><span style='color:#808030;'>]</span><span style='color:#808030;'>=</span>ROTL32<span style='color:#808030;'>(</span>v<span style='color:#808030;'>[</span><span style='color:#008c00;'>3</span><span style='color:#808030;'>]</span><span style='color:#808030;'>,</span><span style='color:#008c00;'>13</span><span style='color:#808030;'>)</span><span style='color:#800080;'>;</span> 
       v<span style='color:#808030;'>[</span><span style='color:#008c00;'>3</span><span style='color:#808030;'>]</span> <span style='color:#808030;'>^</span><span style='color:#808030;'>=</span> v<span style='color:#808030;'>[</span><span style='color:#008c00;'>0</span><span style='color:#808030;'>]</span><span style='color:#800080;'>;</span>
       v<span style='color:#808030;'>[</span><span style='color:#008c00;'>2</span><span style='color:#808030;'>]</span> <span style='color:#808030;'>+</span><span style='color:#808030;'>=</span> v<span style='color:#808030;'>[</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>]</span><span style='color:#800080;'>;</span> 
       v<span style='color:#808030;'>[</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>]</span><span style='color:#808030;'>=</span>ROTL32<span style='color:#808030;'>(</span>v<span style='color:#808030;'>[</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>]</span><span style='color:#808030;'>,</span> <span style='color:#008c00;'>7</span><span style='color:#808030;'>)</span><span style='color:#800080;'>;</span> 
       v<span style='color:#808030;'>[</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>]</span> <span style='color:#808030;'>^</span><span style='color:#808030;'>=</span> v<span style='color:#808030;'>[</span><span style='color:#008c00;'>2</span><span style='color:#808030;'>]</span><span style='color:#800080;'>;</span> 
       v<span style='color:#808030;'>[</span><span style='color:#008c00;'>2</span><span style='color:#808030;'>]</span><span style='color:#808030;'>=</span>ROTL32<span style='color:#808030;'>(</span>v<span style='color:#808030;'>[</span><span style='color:#008c00;'>2</span><span style='color:#808030;'>]</span><span style='color:#808030;'>,</span><span style='color:#008c00;'>16</span><span style='color:#808030;'>)</span><span style='color:#800080;'>;</span>
     <span style='color:#800080;'>}</span> <span style='color:#800000;font-weight:bold;'>else</span> <span style='color:#800080;'>{</span>     
       v<span style='color:#808030;'>[</span><span style='color:#008c00;'>2</span><span style='color:#808030;'>]</span><span style='color:#808030;'>=</span>ROTR32<span style='color:#808030;'>(</span>v<span style='color:#808030;'>[</span><span style='color:#008c00;'>2</span><span style='color:#808030;'>]</span><span style='color:#808030;'>,</span><span style='color:#008c00;'>16</span><span style='color:#808030;'>)</span><span style='color:#800080;'>;</span>
       v<span style='color:#808030;'>[</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>]</span> <span style='color:#808030;'>^</span><span style='color:#808030;'>=</span> v<span style='color:#808030;'>[</span><span style='color:#008c00;'>2</span><span style='color:#808030;'>]</span><span style='color:#800080;'>;</span>
       v<span style='color:#808030;'>[</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>]</span><span style='color:#808030;'>=</span>ROTR32<span style='color:#808030;'>(</span>v<span style='color:#808030;'>[</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>]</span><span style='color:#808030;'>,</span> <span style='color:#008c00;'>7</span><span style='color:#808030;'>)</span><span style='color:#800080;'>;</span>
       v<span style='color:#808030;'>[</span><span style='color:#008c00;'>2</span><span style='color:#808030;'>]</span> <span style='color:#808030;'>-</span><span style='color:#808030;'>=</span> v<span style='color:#808030;'>[</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>]</span><span style='color:#800080;'>;</span>
       v<span style='color:#808030;'>[</span><span style='color:#008c00;'>3</span><span style='color:#808030;'>]</span> <span style='color:#808030;'>^</span><span style='color:#808030;'>=</span> v<span style='color:#808030;'>[</span><span style='color:#008c00;'>0</span><span style='color:#808030;'>]</span><span style='color:#800080;'>;</span>
       v<span style='color:#808030;'>[</span><span style='color:#008c00;'>3</span><span style='color:#808030;'>]</span><span style='color:#808030;'>=</span>ROTR32<span style='color:#808030;'>(</span>v<span style='color:#808030;'>[</span><span style='color:#008c00;'>3</span><span style='color:#808030;'>]</span><span style='color:#808030;'>,</span><span style='color:#008c00;'>13</span><span style='color:#808030;'>)</span><span style='color:#800080;'>;</span>
       v<span style='color:#808030;'>[</span><span style='color:#008c00;'>0</span><span style='color:#808030;'>]</span> <span style='color:#808030;'>-</span><span style='color:#808030;'>=</span> v<span style='color:#808030;'>[</span><span style='color:#008c00;'>3</span><span style='color:#808030;'>]</span><span style='color:#800080;'>;</span>
       v<span style='color:#808030;'>[</span><span style='color:#008c00;'>3</span><span style='color:#808030;'>]</span> <span style='color:#808030;'>^</span><span style='color:#808030;'>=</span> v<span style='color:#808030;'>[</span><span style='color:#008c00;'>2</span><span style='color:#808030;'>]</span><span style='color:#800080;'>;</span>
       v<span style='color:#808030;'>[</span><span style='color:#008c00;'>3</span><span style='color:#808030;'>]</span><span style='color:#808030;'>=</span>ROTR32<span style='color:#808030;'>(</span>v<span style='color:#808030;'>[</span><span style='color:#008c00;'>3</span><span style='color:#808030;'>]</span><span style='color:#808030;'>,</span> <span style='color:#008c00;'>8</span><span style='color:#808030;'>)</span><span style='color:#800080;'>;</span>
       v<span style='color:#808030;'>[</span><span style='color:#008c00;'>2</span><span style='color:#808030;'>]</span> <span style='color:#808030;'>-</span><span style='color:#808030;'>=</span> v<span style='color:#808030;'>[</span><span style='color:#008c00;'>3</span><span style='color:#808030;'>]</span><span style='color:#800080;'>;</span>
       v<span style='color:#808030;'>[</span><span style='color:#008c00;'>0</span><span style='color:#808030;'>]</span><span style='color:#808030;'>=</span>ROTR32<span style='color:#808030;'>(</span>v<span style='color:#808030;'>[</span><span style='color:#008c00;'>0</span><span style='color:#808030;'>]</span><span style='color:#808030;'>,</span><span style='color:#008c00;'>16</span><span style='color:#808030;'>)</span><span style='color:#800080;'>;</span>
       v<span style='color:#808030;'>[</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>]</span> <span style='color:#808030;'>^</span><span style='color:#808030;'>=</span> v<span style='color:#808030;'>[</span><span style='color:#008c00;'>0</span><span style='color:#808030;'>]</span><span style='color:#800080;'>;</span>
       v<span style='color:#808030;'>[</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>]</span><span style='color:#808030;'>=</span>ROTR32<span style='color:#808030;'>(</span>v<span style='color:#808030;'>[</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>]</span><span style='color:#808030;'>,</span> <span style='color:#008c00;'>5</span><span style='color:#808030;'>)</span><span style='color:#800080;'>;</span>
       v<span style='color:#808030;'>[</span><span style='color:#008c00;'>0</span><span style='color:#808030;'>]</span> <span style='color:#808030;'>-</span><span style='color:#808030;'>=</span> v<span style='color:#808030;'>[</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>]</span><span style='color:#800080;'>;</span>
     <span style='color:#800080;'>}</span>
   <span style='color:#800080;'>}</span>
   <span style='color:#696969;'>// post-whiten</span>
   <span style='color:#800000;font-weight:bold;'>for</span> <span style='color:#808030;'>(</span>i<span style='color:#808030;'>=</span><span style='color:#008c00;'>0</span><span style='color:#800080;'>;</span> i<span style='color:#808030;'>&lt;</span><span style='color:#008c00;'>4</span><span style='color:#800080;'>;</span> i<span style='color:#808030;'>+</span><span style='color:#808030;'>+</span><span style='color:#808030;'>)</span> <span style='color:#800080;'>{</span>
     v<span style='color:#808030;'>[</span>i<span style='color:#808030;'>]</span> <span style='color:#808030;'>^</span><span style='color:#808030;'>=</span> k<span style='color:#808030;'>[</span>i<span style='color:#808030;'>]</span><span style='color:#800080;'>;</span>
   <span style='color:#800080;'>}</span>
<span style='color:#800080;'>}</span>
</pre>

<h3><strong>x86 assembly</strong></h3>

<p>The assembly is straight forward. We load buffer into ESI, key into EDI and enc into ECX. Load 4 32-bit registers with 128-bit data, apply pre-whitening with 128-bit key. Test ECX for zero, then save flag status with PUSHFD. This then frees ECX to use as a loop counter which is set to 16 (for LTS). After each round of permutation, restore the flag status with POPFD and keep looping until ECX is zero. Finally apply post-whitening using 128-bit key, save and return.</p>

<pre style='color:#000000;background:#ffffff;'><span style='color:#004a43;'>%define</span><span style='color:#004a43;'> v0 eax</span>
<span style='color:#004a43;'>%define</span><span style='color:#004a43;'> v1 ebx</span>
<span style='color:#004a43;'>%define</span><span style='color:#004a43;'> v2 edx</span>
<span style='color:#004a43;'>%define</span><span style='color:#004a43;'> v3 ebp</span>

<span style='color:#e34adc;'>chaskey:</span>
<span style='color:#e34adc;'>_chaskey:</span>
    <span style='color:#800000;font-weight:bold;'>pushad</span>
    <span style='color:#800000;font-weight:bold;'>lea</span>     <span style='color:#000080;'>esi</span><span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>esp</span><span style='color:#808030;'>+</span><span style='color:#008c00;'>32</span><span style='color:#008c00;'>+4</span><span style='color:#808030;'>]</span>
    <span style='color:#800000;font-weight:bold;'>lodsd</span>
    <span style='color:#800000;font-weight:bold;'>xchg</span>    <span style='color:#000080;'>ecx</span><span style='color:#808030;'>,</span> <span style='color:#000080;'>eax</span>          <span style='color:#696969;'>; ecx = enc</span>
    <span style='color:#800000;font-weight:bold;'>lodsd</span>
    <span style='color:#800000;font-weight:bold;'>xchg</span>    <span style='color:#000080;'>edi</span><span style='color:#808030;'>,</span> <span style='color:#000080;'>eax</span>          <span style='color:#696969;'>; edi = key</span>
    <span style='color:#800000;font-weight:bold;'>lodsd</span>
    <span style='color:#800000;font-weight:bold;'>xchg</span>    <span style='color:#000080;'>eax</span><span style='color:#808030;'>,</span> <span style='color:#000080;'>esi</span>          <span style='color:#696969;'>; esi = buf</span>
    <span style='color:#800000;font-weight:bold;'>push</span>    <span style='color:#000080;'>esi</span>
    <span style='color:#696969;'>; load buf</span>
    <span style='color:#800000;font-weight:bold;'>lodsd</span>
    <span style='color:#800000;font-weight:bold;'>xchg</span>    <span style='color:#000080;'>eax</span><span style='color:#808030;'>,</span> v3
    <span style='color:#800000;font-weight:bold;'>lodsd</span>
    <span style='color:#800000;font-weight:bold;'>xchg</span>    <span style='color:#000080;'>eax</span><span style='color:#808030;'>,</span> v1
    <span style='color:#800000;font-weight:bold;'>lodsd</span>
    <span style='color:#800000;font-weight:bold;'>xchg</span>    <span style='color:#000080;'>eax</span><span style='color:#808030;'>,</span> v2
    <span style='color:#800000;font-weight:bold;'>lodsd</span>
    <span style='color:#800000;font-weight:bold;'>xchg</span>    <span style='color:#000080;'>eax</span><span style='color:#808030;'>,</span> v3
    <span style='color:#696969;'>; pre-whiten</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>     v0<span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>edi</span>   <span style='color:#808030;'>]</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>     v1<span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>edi</span><span style='color:#808030;'>+</span> <span style='color:#008c00;'>4</span><span style='color:#808030;'>]</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>     v2<span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>edi</span><span style='color:#808030;'>+</span> <span style='color:#008c00;'>8</span><span style='color:#808030;'>]</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>     v3<span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>edi</span><span style='color:#808030;'>+</span><span style='color:#008c00;'>12</span><span style='color:#808030;'>]</span>
    <span style='color:#800000;font-weight:bold;'>test</span>    <span style='color:#000080;'>ecx</span><span style='color:#808030;'>,</span> <span style='color:#000080;'>ecx</span>
    <span style='color:#800000;font-weight:bold;'>mov</span>     <span style='color:#000080;'>cl</span><span style='color:#808030;'>,</span> <span style='color:#008c00;'>16</span>
<span style='color:#e34adc;'>ck_l0:</span>
    <span style='color:#800000;font-weight:bold;'>pushfd</span>
    <span style='color:#800000;font-weight:bold;'>jz</span>      <span style='color:#e34adc;'>ck_l1</span>
    <span style='color:#696969;'>; encrypt</span>
    <span style='color:#800000;font-weight:bold;'>add</span>     v0<span style='color:#808030;'>,</span> v1
    <span style='color:#800000;font-weight:bold;'>rol</span>     v1<span style='color:#808030;'>,</span> <span style='color:#008c00;'>5</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>     v1<span style='color:#808030;'>,</span> v0
    <span style='color:#800000;font-weight:bold;'>rol</span>     v0<span style='color:#808030;'>,</span> <span style='color:#008c00;'>16</span>
    <span style='color:#800000;font-weight:bold;'>add</span>     v2<span style='color:#808030;'>,</span> v3
    <span style='color:#800000;font-weight:bold;'>rol</span>     v3<span style='color:#808030;'>,</span> <span style='color:#008c00;'>8</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>     v3<span style='color:#808030;'>,</span> v2
    <span style='color:#800000;font-weight:bold;'>add</span>     v0<span style='color:#808030;'>,</span> v3
    <span style='color:#800000;font-weight:bold;'>rol</span>     v3<span style='color:#808030;'>,</span> <span style='color:#008c00;'>13</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>     v3<span style='color:#808030;'>,</span> v0
    <span style='color:#800000;font-weight:bold;'>add</span>     v2<span style='color:#808030;'>,</span> v1
    <span style='color:#800000;font-weight:bold;'>rol</span>     v1<span style='color:#808030;'>,</span> <span style='color:#008c00;'>7</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>     v1<span style='color:#808030;'>,</span> v2
    <span style='color:#800000;font-weight:bold;'>rol</span>     v2<span style='color:#808030;'>,</span> <span style='color:#008c00;'>16</span>
    <span style='color:#800000;font-weight:bold;'>jmp</span>     <span style='color:#e34adc;'>ck_l2</span>
<span style='color:#e34adc;'>ck_l1:</span>
    <span style='color:#696969;'>; decrypt</span>
    <span style='color:#800000;font-weight:bold;'>ror</span>     v2<span style='color:#808030;'>,</span> <span style='color:#008c00;'>16</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>     v1<span style='color:#808030;'>,</span> v2
    <span style='color:#800000;font-weight:bold;'>ror</span>     v1<span style='color:#808030;'>,</span> <span style='color:#008c00;'>7</span>
    <span style='color:#800000;font-weight:bold;'>sub</span>     v2<span style='color:#808030;'>,</span> v1
    <span style='color:#800000;font-weight:bold;'>xor</span>     v3<span style='color:#808030;'>,</span> v0
    <span style='color:#800000;font-weight:bold;'>ror</span>     v3<span style='color:#808030;'>,</span> <span style='color:#008c00;'>13</span>
    <span style='color:#800000;font-weight:bold;'>sub</span>     v0<span style='color:#808030;'>,</span> v3
    <span style='color:#800000;font-weight:bold;'>xor</span>     v3<span style='color:#808030;'>,</span> v2
    <span style='color:#800000;font-weight:bold;'>ror</span>     v3<span style='color:#808030;'>,</span> <span style='color:#008c00;'>8</span>
    <span style='color:#800000;font-weight:bold;'>sub</span>     v2<span style='color:#808030;'>,</span> v3
    <span style='color:#800000;font-weight:bold;'>ror</span>     v0<span style='color:#808030;'>,</span> <span style='color:#008c00;'>16</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>     v1<span style='color:#808030;'>,</span> v0
    <span style='color:#800000;font-weight:bold;'>ror</span>     v1<span style='color:#808030;'>,</span> <span style='color:#008c00;'>5</span>
    <span style='color:#800000;font-weight:bold;'>sub</span>     v0<span style='color:#808030;'>,</span> v1
<span style='color:#e34adc;'>ck_l2:</span>
    <span style='color:#800000;font-weight:bold;'>popfd</span>
    <span style='color:#800000;font-weight:bold;'>loop</span>    <span style='color:#e34adc;'>ck_l0</span>
<span style='color:#e34adc;'>ck_l3:</span>
    <span style='color:#696969;'>; post-whiten</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>     v0<span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>edi</span>   <span style='color:#808030;'>]</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>     v1<span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>edi</span><span style='color:#808030;'>+</span> <span style='color:#008c00;'>4</span><span style='color:#808030;'>]</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>     v2<span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>edi</span><span style='color:#808030;'>+</span> <span style='color:#008c00;'>8</span><span style='color:#808030;'>]</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>     v3<span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>edi</span><span style='color:#808030;'>+</span><span style='color:#008c00;'>12</span><span style='color:#808030;'>]</span>
    <span style='color:#800000;font-weight:bold;'>pop</span>     <span style='color:#000080;'>edi</span>
    <span style='color:#696969;'>; save buf</span>
    <span style='color:#800000;font-weight:bold;'>stosd</span>
    <span style='color:#800000;font-weight:bold;'>xchg</span>    <span style='color:#000080;'>eax</span><span style='color:#808030;'>,</span> v1
    <span style='color:#800000;font-weight:bold;'>stosd</span>
    <span style='color:#800000;font-weight:bold;'>xchg</span>    <span style='color:#000080;'>eax</span><span style='color:#808030;'>,</span> v2
    <span style='color:#800000;font-weight:bold;'>stosd</span>
    <span style='color:#800000;font-weight:bold;'>xchg</span>    <span style='color:#000080;'>eax</span><span style='color:#808030;'>,</span> v3
    <span style='color:#800000;font-weight:bold;'>stosd</span>
    <span style='color:#800000;font-weight:bold;'>popad</span>
    <span style='color:#800000;font-weight:bold;'>ret</span>
</pre>

<h3><strong>Compact code</strong></h3>

<pre style='color:#000000;background:#ffffff;'><span style='color:#004a43; '>#</span><span style='color:#004a43; '>define</span><span style='color:#004a43; '> R</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>v</span><span style='color:#808030; '>,</span><span style='color:#004a43; '>n</span><span style='color:#808030; '>)</span><span style='color:#808030; '>(</span><span style='color:#808030; '>(</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>v</span><span style='color:#808030; '>)</span><span style='color:#808030; '>></span><span style='color:#808030; '>></span><span style='color:#808030; '>(</span><span style='color:#004a43; '>n</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>|</span><span style='color:#808030; '>(</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>v</span><span style='color:#808030; '>)</span><span style='color:#808030; '>&lt;</span><span style='color:#808030; '>&lt;</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>32</span><span style='color:#808030; '>-</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>n</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span>
<span style='color:#004a43; '>#</span><span style='color:#004a43; '>define</span><span style='color:#004a43; '> F</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>n</span><span style='color:#808030; '>)</span><span style='color:#004a43; '>for</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>i</span><span style='color:#808030; '>=</span><span style='color:#004a43; '>0</span><span style='color:#808030; '>;</span><span style='color:#004a43; '>i</span><span style='color:#808030; '>&lt;</span><span style='color:#004a43; '>n</span><span style='color:#808030; '>;</span><span style='color:#004a43; '>i</span><span style='color:#808030; '>+</span><span style='color:#808030; '>+</span><span style='color:#808030; '>)</span>
  
<span style='color:#800000; font-weight:bold; '>void</span> chaskey<span style='color:#808030; '>(</span><span style='color:#800000; font-weight:bold; '>void</span><span style='color:#808030; '>*</span>mk<span style='color:#808030; '>,</span><span style='color:#800000; font-weight:bold; '>void</span><span style='color:#808030; '>*</span>p<span style='color:#808030; '>)</span><span style='color:#800080; '>{</span>
    <span style='color:#800000; font-weight:bold; '>unsigned</span> <span style='color:#800000; font-weight:bold; '>int</span> i<span style='color:#808030; '>,</span><span style='color:#808030; '>*</span>x<span style='color:#808030; '>=</span>p<span style='color:#808030; '>,</span><span style='color:#808030; '>*</span>k<span style='color:#808030; '>=</span>mk<span style='color:#800080; '>;</span>

    F<span style='color:#808030; '>(</span><span style='color:#008c00; '>4</span><span style='color:#808030; '>)</span>x<span style='color:#808030; '>[</span>i<span style='color:#808030; '>]</span><span style='color:#808030; '>^</span><span style='color:#808030; '>=</span>k<span style='color:#808030; '>[</span>i<span style='color:#808030; '>]</span><span style='color:#800080; '>;</span>
    F<span style='color:#808030; '>(</span><span style='color:#008c00; '>16</span><span style='color:#808030; '>)</span>
      <span style='color:#808030; '>*</span>x<span style='color:#808030; '>+</span><span style='color:#808030; '>=</span>x<span style='color:#808030; '>[</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span>
      x<span style='color:#808030; '>[</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>R<span style='color:#808030; '>(</span>x<span style='color:#808030; '>[</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span><span style='color:#008c00; '>27</span><span style='color:#808030; '>)</span><span style='color:#808030; '>^</span><span style='color:#808030; '>*</span>x<span style='color:#808030; '>,</span>
      x<span style='color:#808030; '>[</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>]</span><span style='color:#808030; '>+</span><span style='color:#808030; '>=</span>x<span style='color:#808030; '>[</span><span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span>
      x<span style='color:#808030; '>[</span><span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>R<span style='color:#808030; '>(</span>x<span style='color:#808030; '>[</span><span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span><span style='color:#008c00; '>24</span><span style='color:#808030; '>)</span><span style='color:#808030; '>^</span>x<span style='color:#808030; '>[</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span>
      x<span style='color:#808030; '>[</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>]</span><span style='color:#808030; '>+</span><span style='color:#808030; '>=</span>x<span style='color:#808030; '>[</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span>
      <span style='color:#808030; '>*</span>x<span style='color:#808030; '>=</span>R<span style='color:#808030; '>(</span><span style='color:#808030; '>*</span>x<span style='color:#808030; '>,</span><span style='color:#008c00; '>16</span><span style='color:#808030; '>)</span><span style='color:#808030; '>+</span>x<span style='color:#808030; '>[</span><span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span>
      x<span style='color:#808030; '>[</span><span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>R<span style='color:#808030; '>(</span>x<span style='color:#808030; '>[</span><span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span><span style='color:#008c00; '>19</span><span style='color:#808030; '>)</span><span style='color:#808030; '>^</span><span style='color:#808030; '>*</span>x<span style='color:#808030; '>,</span>
      x<span style='color:#808030; '>[</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>R<span style='color:#808030; '>(</span>x<span style='color:#808030; '>[</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span><span style='color:#008c00; '>25</span><span style='color:#808030; '>)</span><span style='color:#808030; '>^</span>x<span style='color:#808030; '>[</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span>
      x<span style='color:#808030; '>[</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>R<span style='color:#808030; '>(</span>x<span style='color:#808030; '>[</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span><span style='color:#008c00; '>16</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
    F<span style='color:#808030; '>(</span><span style='color:#008c00; '>4</span><span style='color:#808030; '>)</span>x<span style='color:#808030; '>[</span>i<span style='color:#808030; '>]</span><span style='color:#808030; '>^</span><span style='color:#808030; '>=</span>k<span style='color:#808030; '>[</span>i<span style='color:#808030; '>]</span><span style='color:#800080; '>;</span>
<span style='color:#800080; '>}</span>
</pre>

<h3><strong>x86 assembly</strong></h3>

<pre style='color:#000000;background:#ffffff;'><span style='color:#696969;'>; -----------------------------------------------</span>
<span style='color:#696969;'>; Chaskey-LTS block cipher in x86 assembly (encryption only)</span>
<span style='color:#696969;'>;</span>
<span style='color:#696969;'>; size: 89 bytes</span>
<span style='color:#696969;'>;</span>
<span style='color:#696969;'>; global calls use cdecl convention</span>
<span style='color:#696969;'>;</span>
<span style='color:#696969;'>; -----------------------------------------------</span>

    <span style='color:#004a43;'>bits</span> <span style='color:#008c00;'>32</span>

<span style='color:#004a43;'>%ifndef</span><span style='color:#004a43;'> BIN</span>
  <span style='color:#004a43;'>global</span> chaskey
  <span style='color:#004a43;'>global</span> _chaskey
<span style='color:#004a43;'>%endif</span>

<span style='color:#004a43;'>%define</span><span style='color:#004a43;'> v0 eax</span>
<span style='color:#004a43;'>%define</span><span style='color:#004a43;'> v1 ebx</span>
<span style='color:#004a43;'>%define</span><span style='color:#004a43;'> v2 edx</span>
<span style='color:#004a43;'>%define</span><span style='color:#004a43;'> v3 ebp</span>

<span style='color:#e34adc;'>chaskey:</span>
<span style='color:#e34adc;'>_chaskey:</span>
    <span style='color:#800000;font-weight:bold;'>pushad</span>
    <span style='color:#800000;font-weight:bold;'>mov</span>     <span style='color:#000080;'>edi</span><span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>esp</span><span style='color:#808030;'>+</span><span style='color:#008c00;'>32</span><span style='color:#808030;'>+</span> <span style='color:#008c00;'>8</span><span style='color:#808030;'>]</span>
    <span style='color:#800000;font-weight:bold;'>mov</span>     <span style='color:#000080;'>esi</span><span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>esp</span><span style='color:#808030;'>+</span><span style='color:#008c00;'>32</span><span style='color:#008c00;'>+12</span><span style='color:#808030;'>]</span>
    <span style='color:#800000;font-weight:bold;'>push</span>    <span style='color:#000080;'>esi</span>
    <span style='color:#696969;'>; load buf</span>
    <span style='color:#800000;font-weight:bold;'>lodsd</span>
    <span style='color:#800000;font-weight:bold;'>xchg</span>    <span style='color:#000080;'>eax</span><span style='color:#808030;'>,</span> v3
    <span style='color:#800000;font-weight:bold;'>lodsd</span>
    <span style='color:#800000;font-weight:bold;'>xchg</span>    <span style='color:#000080;'>eax</span><span style='color:#808030;'>,</span> v1
    <span style='color:#800000;font-weight:bold;'>lodsd</span>
    <span style='color:#800000;font-weight:bold;'>xchg</span>    <span style='color:#000080;'>eax</span><span style='color:#808030;'>,</span> v2
    <span style='color:#800000;font-weight:bold;'>lodsd</span>
    <span style='color:#800000;font-weight:bold;'>xchg</span>    <span style='color:#000080;'>eax</span><span style='color:#808030;'>,</span> v3
    <span style='color:#696969;'>; pre-whiten</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>     v0<span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>edi</span>   <span style='color:#808030;'>]</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>     v1<span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>edi</span><span style='color:#808030;'>+</span> <span style='color:#008c00;'>4</span><span style='color:#808030;'>]</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>     v2<span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>edi</span><span style='color:#808030;'>+</span> <span style='color:#008c00;'>8</span><span style='color:#808030;'>]</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>     v3<span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>edi</span><span style='color:#808030;'>+</span><span style='color:#008c00;'>12</span><span style='color:#808030;'>]</span>
    <span style='color:#696969;'>; 16 rounds</span>
    <span style='color:#800000;font-weight:bold;'>push</span>    <span style='color:#008c00;'>16</span>
    <span style='color:#800000;font-weight:bold;'>pop</span>     <span style='color:#000080;'>ecx</span>
<span style='color:#e34adc;'>ck_l0:</span>    
    <span style='color:#696969;'>; apply permutation</span>
    <span style='color:#800000;font-weight:bold;'>add</span>     v0<span style='color:#808030;'>,</span> v1
    <span style='color:#800000;font-weight:bold;'>rol</span>     v1<span style='color:#808030;'>,</span> <span style='color:#008c00;'>5</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>     v1<span style='color:#808030;'>,</span> v0
    <span style='color:#800000;font-weight:bold;'>rol</span>     v0<span style='color:#808030;'>,</span> <span style='color:#008c00;'>16</span>
    <span style='color:#800000;font-weight:bold;'>add</span>     v2<span style='color:#808030;'>,</span> v3
    <span style='color:#800000;font-weight:bold;'>rol</span>     v3<span style='color:#808030;'>,</span> <span style='color:#008c00;'>8</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>     v3<span style='color:#808030;'>,</span> v2
    <span style='color:#800000;font-weight:bold;'>add</span>     v0<span style='color:#808030;'>,</span> v3
    <span style='color:#800000;font-weight:bold;'>rol</span>     v3<span style='color:#808030;'>,</span> <span style='color:#008c00;'>13</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>     v3<span style='color:#808030;'>,</span> v0
    <span style='color:#800000;font-weight:bold;'>add</span>     v2<span style='color:#808030;'>,</span> v1
    <span style='color:#800000;font-weight:bold;'>rol</span>     v1<span style='color:#808030;'>,</span> <span style='color:#008c00;'>7</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>     v1<span style='color:#808030;'>,</span> v2
    <span style='color:#800000;font-weight:bold;'>rol</span>     v2<span style='color:#808030;'>,</span> <span style='color:#008c00;'>16</span>
    <span style='color:#800000;font-weight:bold;'>loop</span>    <span style='color:#e34adc;'>ck_l0</span>
    <span style='color:#696969;'>; post-whiten</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>     v0<span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>edi</span>   <span style='color:#808030;'>]</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>     v1<span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>edi</span><span style='color:#808030;'>+</span> <span style='color:#008c00;'>4</span><span style='color:#808030;'>]</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>     v2<span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>edi</span><span style='color:#808030;'>+</span> <span style='color:#008c00;'>8</span><span style='color:#808030;'>]</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>     v3<span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>edi</span><span style='color:#808030;'>+</span><span style='color:#008c00;'>12</span><span style='color:#808030;'>]</span>
    <span style='color:#800000;font-weight:bold;'>pop</span>     <span style='color:#000080;'>edi</span>
    <span style='color:#696969;'>; save buf</span>
    <span style='color:#800000;font-weight:bold;'>stosd</span>
    <span style='color:#800000;font-weight:bold;'>xchg</span>    <span style='color:#000080;'>eax</span><span style='color:#808030;'>,</span> v1
    <span style='color:#800000;font-weight:bold;'>stosd</span>
    <span style='color:#800000;font-weight:bold;'>xchg</span>    <span style='color:#000080;'>eax</span><span style='color:#808030;'>,</span> v2
    <span style='color:#800000;font-weight:bold;'>stosd</span>
    <span style='color:#800000;font-weight:bold;'>xchg</span>    <span style='color:#000080;'>eax</span><span style='color:#808030;'>,</span> v3
    <span style='color:#800000;font-weight:bold;'>stosd</span>
    <span style='color:#800000;font-weight:bold;'>popad</span>
    <span style='color:#800000;font-weight:bold;'>ret</span>
</pre>

<h3><strong>ARM32 / AArch32 assembly</strong></h3>

<pre style='color:#000000;background:#ffffff;'>k  .req r0
x  .req r1

k0 .req r2
k1 .req r3
k2 .req r4
k3 .req r5

x0 .req r6
x1 .req r7
x2 .req r8
x3 .req r9

i  .req r1<span style='color:#008c00;'>0</span>
  
  <span style='color:#808030;'>/</span><span style='color:#808030;'>/</span> chaskey<span style='color:#808030;'>(</span>void <span style='color:#808030;'>*</span>key<span style='color:#808030;'>,</span> void <span style='color:#808030;'>*</span><span style='color:#004a43;'>data</span><span style='color:#808030;'>)</span><span style='color:#696969;'>;</span>
<span style='color:#e34adc;'>chaskey:</span>
  
  <span style='color:#808030;'>/</span><span style='color:#808030;'>/</span> saxe registers
  <span style='color:#800000;font-weight:bold;'>push</span>   <span style='color:#808030;'>{</span>r0<span style='color:#808030;'>-</span>r1<span style='color:#008c00;'>2</span><span style='color:#808030;'>,</span>lr<span style='color:#808030;'>}</span>
  
  <span style='color:#808030;'>/</span><span style='color:#808030;'>/</span> load <span style='color:#008c00;'>128</span><span style='color:#808030;'>-</span>bit key
  ldm    k<span style='color:#808030;'>,</span> <span style='color:#808030;'>{</span>k0<span style='color:#808030;'>,</span> k1<span style='color:#808030;'>,</span> k2<span style='color:#808030;'>,</span> k3<span style='color:#808030;'>}</span>
  
  <span style='color:#808030;'>/</span><span style='color:#808030;'>/</span> load <span style='color:#008c00;'>128</span><span style='color:#808030;'>-</span>bit plaintext
  ldm    x<span style='color:#808030;'>,</span> <span style='color:#808030;'>{</span>x0<span style='color:#808030;'>,</span> x1<span style='color:#808030;'>,</span> x2<span style='color:#808030;'>,</span> x3<span style='color:#808030;'>}</span>
  
  <span style='color:#808030;'>/</span><span style='color:#808030;'>/</span> <span style='color:#800000;font-weight:bold;'>xor</span> plaintext <span style='color:#004a43;'>with</span> key
  eor    x0<span style='color:#808030;'>,</span> x0<span style='color:#808030;'>,</span> k0          <span style='color:#808030;'>/</span><span style='color:#808030;'>/</span> x<span style='color:#808030;'>[</span><span style='color:#008c00;'>0</span><span style='color:#808030;'>]</span> <span style='color:#808030;'>^</span><span style='color:#808030;'>=</span> k<span style='color:#808030;'>[</span><span style='color:#008c00;'>0</span><span style='color:#808030;'>]</span><span style='color:#696969;'>;</span>
  eor    x1<span style='color:#808030;'>,</span> x1<span style='color:#808030;'>,</span> k1          <span style='color:#808030;'>/</span><span style='color:#808030;'>/</span> x<span style='color:#808030;'>[</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>]</span> <span style='color:#808030;'>^</span><span style='color:#808030;'>=</span> k<span style='color:#808030;'>[</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>]</span><span style='color:#696969;'>;</span>
  eor    x2<span style='color:#808030;'>,</span> x2<span style='color:#808030;'>,</span> k2          <span style='color:#808030;'>/</span><span style='color:#808030;'>/</span> x<span style='color:#808030;'>[</span><span style='color:#008c00;'>2</span><span style='color:#808030;'>]</span> <span style='color:#808030;'>^</span><span style='color:#808030;'>=</span> k<span style='color:#808030;'>[</span><span style='color:#008c00;'>2</span><span style='color:#808030;'>]</span><span style='color:#696969;'>;</span>
  eor    x3<span style='color:#808030;'>,</span> x3<span style='color:#808030;'>,</span> k3          <span style='color:#808030;'>/</span><span style='color:#808030;'>/</span> x<span style='color:#808030;'>[</span><span style='color:#008c00;'>3</span><span style='color:#808030;'>]</span> <span style='color:#808030;'>^</span><span style='color:#808030;'>=</span> k<span style='color:#808030;'>[</span><span style='color:#008c00;'>3</span><span style='color:#808030;'>]</span><span style='color:#696969;'>;</span>
  <span style='color:#800000;font-weight:bold;'>mov</span>    i<span style='color:#808030;'>,</span> #<span style='color:#008c00;'>16</span>              <span style='color:#808030;'>/</span><span style='color:#808030;'>/</span> i <span style='color:#808030;'>=</span> <span style='color:#008c00;'>16</span>
<span style='color:#e34adc;'>chaskey_loop:</span>
  <span style='color:#800000;font-weight:bold;'>add</span>    x0<span style='color:#808030;'>,</span> x0<span style='color:#808030;'>,</span> x1          <span style='color:#808030;'>/</span><span style='color:#808030;'>/</span> x<span style='color:#808030;'>[</span><span style='color:#008c00;'>0</span><span style='color:#808030;'>]</span> <span style='color:#808030;'>+</span><span style='color:#808030;'>=</span> x<span style='color:#808030;'>[</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>]</span><span style='color:#696969;'>;</span>
  eor    x1<span style='color:#808030;'>,</span> x0<span style='color:#808030;'>,</span> x1<span style='color:#808030;'>,</span> <span style='color:#800000;font-weight:bold;'>ror</span> #<span style='color:#008c00;'>27</span> <span style='color:#808030;'>/</span><span style='color:#808030;'>/</span> x<span style='color:#808030;'>[</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>]</span><span style='color:#808030;'>=</span>ROTL3<span style='color:#008c00;'>2</span><span style='color:#808030;'>(</span>x<span style='color:#808030;'>[</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>]</span><span style='color:#808030;'>,</span>  <span style='color:#008c00;'>5</span><span style='color:#808030;'>)</span> <span style='color:#808030;'>^</span> x<span style='color:#808030;'>[</span><span style='color:#008c00;'>0</span><span style='color:#808030;'>]</span><span style='color:#696969;'>;</span>
  <span style='color:#800000;font-weight:bold;'>add</span>    x2<span style='color:#808030;'>,</span> x2<span style='color:#808030;'>,</span> x3          <span style='color:#808030;'>/</span><span style='color:#808030;'>/</span> x<span style='color:#808030;'>[</span><span style='color:#008c00;'>2</span><span style='color:#808030;'>]</span> <span style='color:#808030;'>+</span><span style='color:#808030;'>=</span> x<span style='color:#808030;'>[</span><span style='color:#008c00;'>3</span><span style='color:#808030;'>]</span><span style='color:#696969;'>;</span>
  eor    x3<span style='color:#808030;'>,</span> x2<span style='color:#808030;'>,</span> x3<span style='color:#808030;'>,</span> <span style='color:#800000;font-weight:bold;'>ror</span> #<span style='color:#008c00;'>24</span> <span style='color:#808030;'>/</span><span style='color:#808030;'>/</span> x<span style='color:#808030;'>[</span><span style='color:#008c00;'>3</span><span style='color:#808030;'>]</span><span style='color:#808030;'>=</span>ROTL3<span style='color:#008c00;'>2</span><span style='color:#808030;'>(</span>x<span style='color:#808030;'>[</span><span style='color:#008c00;'>3</span><span style='color:#808030;'>]</span><span style='color:#808030;'>,</span>  <span style='color:#008c00;'>8</span><span style='color:#808030;'>)</span> <span style='color:#808030;'>^</span> x<span style='color:#808030;'>[</span><span style='color:#008c00;'>2</span><span style='color:#808030;'>]</span><span style='color:#696969;'>;</span>
  <span style='color:#800000;font-weight:bold;'>add</span>    x2<span style='color:#808030;'>,</span> x2<span style='color:#808030;'>,</span> x1          <span style='color:#808030;'>/</span><span style='color:#808030;'>/</span> x<span style='color:#808030;'>[</span><span style='color:#008c00;'>2</span><span style='color:#808030;'>]</span> <span style='color:#808030;'>+</span><span style='color:#808030;'>=</span> x<span style='color:#808030;'>[</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>]</span><span style='color:#696969;'>;</span>
  <span style='color:#800000;font-weight:bold;'>add</span>    x0<span style='color:#808030;'>,</span> x3<span style='color:#808030;'>,</span> x0<span style='color:#808030;'>,</span> <span style='color:#800000;font-weight:bold;'>ror</span> #<span style='color:#008c00;'>16</span> <span style='color:#808030;'>/</span><span style='color:#808030;'>/</span> x<span style='color:#808030;'>[</span><span style='color:#008c00;'>0</span><span style='color:#808030;'>]</span><span style='color:#808030;'>=</span>ROTL3<span style='color:#008c00;'>2</span><span style='color:#808030;'>(</span>x<span style='color:#808030;'>[</span><span style='color:#008c00;'>0</span><span style='color:#808030;'>]</span><span style='color:#808030;'>,</span> <span style='color:#008c00;'>16</span><span style='color:#808030;'>)</span> <span style='color:#808030;'>+</span> x<span style='color:#808030;'>[</span><span style='color:#008c00;'>3</span><span style='color:#808030;'>]</span><span style='color:#696969;'>;</span>
  eor    x3<span style='color:#808030;'>,</span> x0<span style='color:#808030;'>,</span> x3<span style='color:#808030;'>,</span> <span style='color:#800000;font-weight:bold;'>ror</span> #<span style='color:#008c00;'>19</span> <span style='color:#808030;'>/</span><span style='color:#808030;'>/</span> x<span style='color:#808030;'>[</span><span style='color:#008c00;'>3</span><span style='color:#808030;'>]</span><span style='color:#808030;'>=</span>ROTL3<span style='color:#008c00;'>2</span><span style='color:#808030;'>(</span>x<span style='color:#808030;'>[</span><span style='color:#008c00;'>3</span><span style='color:#808030;'>]</span><span style='color:#808030;'>,</span> <span style='color:#008c00;'>13</span><span style='color:#808030;'>)</span> <span style='color:#808030;'>^</span> x<span style='color:#808030;'>[</span><span style='color:#008c00;'>0</span><span style='color:#808030;'>]</span><span style='color:#696969;'>;</span>
  eor    x1<span style='color:#808030;'>,</span> x2<span style='color:#808030;'>,</span> x1<span style='color:#808030;'>,</span> <span style='color:#800000;font-weight:bold;'>ror</span> #<span style='color:#008c00;'>25</span> <span style='color:#808030;'>/</span><span style='color:#808030;'>/</span> x<span style='color:#808030;'>[</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>]</span><span style='color:#808030;'>=</span>ROTL3<span style='color:#008c00;'>2</span><span style='color:#808030;'>(</span>x<span style='color:#808030;'>[</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>]</span><span style='color:#808030;'>,</span>  <span style='color:#008c00;'>7</span><span style='color:#808030;'>)</span> <span style='color:#808030;'>^</span> x<span style='color:#808030;'>[</span><span style='color:#008c00;'>2</span><span style='color:#808030;'>]</span><span style='color:#696969;'>;</span>
  <span style='color:#800000;font-weight:bold;'>mov</span>    x2<span style='color:#808030;'>,</span> x2<span style='color:#808030;'>,</span> <span style='color:#800000;font-weight:bold;'>ror</span> #<span style='color:#008c00;'>16</span>     <span style='color:#808030;'>/</span><span style='color:#808030;'>/</span> x<span style='color:#808030;'>[</span><span style='color:#008c00;'>2</span><span style='color:#808030;'>]</span><span style='color:#808030;'>=</span>ROTL3<span style='color:#008c00;'>2</span><span style='color:#808030;'>(</span>x<span style='color:#808030;'>[</span><span style='color:#008c00;'>2</span><span style='color:#808030;'>]</span><span style='color:#808030;'>,</span> <span style='color:#008c00;'>16</span><span style='color:#808030;'>)</span><span style='color:#696969;'>;</span>
  subs   i<span style='color:#808030;'>,</span> i<span style='color:#808030;'>,</span> #<span style='color:#008c00;'>1</span>            <span style='color:#808030;'>/</span><span style='color:#808030;'>/</span> i<span style='color:#808030;'>-</span><span style='color:#808030;'>-</span>
  bne    chaskey_loop        <span style='color:#808030;'>/</span><span style='color:#808030;'>/</span> i<span style='color:#808030;'>&gt;</span><span style='color:#008c00;'>0</span>
  
  <span style='color:#808030;'>/</span><span style='color:#808030;'>/</span> <span style='color:#800000;font-weight:bold;'>xor</span> ciphertext <span style='color:#004a43;'>with</span> key
  eor    x0<span style='color:#808030;'>,</span> x0<span style='color:#808030;'>,</span> k0          <span style='color:#808030;'>/</span><span style='color:#808030;'>/</span> x<span style='color:#808030;'>[</span><span style='color:#008c00;'>0</span><span style='color:#808030;'>]</span> <span style='color:#808030;'>^</span><span style='color:#808030;'>=</span> k<span style='color:#808030;'>[</span><span style='color:#008c00;'>0</span><span style='color:#808030;'>]</span><span style='color:#696969;'>;</span>
  eor    x1<span style='color:#808030;'>,</span> x1<span style='color:#808030;'>,</span> k1          <span style='color:#808030;'>/</span><span style='color:#808030;'>/</span> x<span style='color:#808030;'>[</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>]</span> <span style='color:#808030;'>^</span><span style='color:#808030;'>=</span> k<span style='color:#808030;'>[</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>]</span><span style='color:#696969;'>;</span>
  eor    x2<span style='color:#808030;'>,</span> x2<span style='color:#808030;'>,</span> k2          <span style='color:#808030;'>/</span><span style='color:#808030;'>/</span> x<span style='color:#808030;'>[</span><span style='color:#008c00;'>2</span><span style='color:#808030;'>]</span> <span style='color:#808030;'>^</span><span style='color:#808030;'>=</span> k<span style='color:#808030;'>[</span><span style='color:#008c00;'>2</span><span style='color:#808030;'>]</span><span style='color:#696969;'>;</span>
  eor    x3<span style='color:#808030;'>,</span> x3<span style='color:#808030;'>,</span> k3          <span style='color:#808030;'>/</span><span style='color:#808030;'>/</span> x<span style='color:#808030;'>[</span><span style='color:#008c00;'>3</span><span style='color:#808030;'>]</span> <span style='color:#808030;'>^</span><span style='color:#808030;'>=</span> k<span style='color:#808030;'>[</span><span style='color:#008c00;'>3</span><span style='color:#808030;'>]</span><span style='color:#696969;'>;</span>
  
  <span style='color:#808030;'>/</span><span style='color:#808030;'>/</span> save ciphertext
  stm    x<span style='color:#808030;'>,</span> <span style='color:#808030;'>{</span>x0<span style='color:#808030;'>,</span> x1<span style='color:#808030;'>,</span> x2<span style='color:#808030;'>,</span> x3<span style='color:#808030;'>}</span>
  
  <span style='color:#808030;'>/</span><span style='color:#808030;'>/</span> restore registers
  <span style='color:#800000;font-weight:bold;'>pop</span>    <span style='color:#808030;'>{</span>r0<span style='color:#808030;'>-</span>r1<span style='color:#008c00;'>2</span><span style='color:#808030;'>,</span>pc<span style='color:#808030;'>}</span>
</pre>

<h3><strong>ARM64 / AArch64 assembly</strong></h3>

<pre style='color:#000000;background:#ffffff;'><span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> CHASKEY <span style='color:#800000; font-weight:bold; '>in</span> ARM6<span style='color:#008c00; '>4</span> assembly
<span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> <span style='color:#008c00; '>112</span> bytes

  .arch armv8<span style='color:#808030; '>-</span>a  
  .text
  
  .<span style='color:#004a43; '>global</span> chaskey

  <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> chaskey<span style='color:#808030; '>(</span>void<span style='color:#808030; '>*</span>mk<span style='color:#808030; '>,</span> void<span style='color:#808030; '>*</span><span style='color:#004a43; '>data</span><span style='color:#808030; '>)</span><span style='color:#696969; '>;</span>
<span style='color:#e34adc; '>chaskey:</span>
    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> load <span style='color:#008c00; '>128</span><span style='color:#808030; '>-</span>bit key
    ldp    w2<span style='color:#808030; '>,</span> w3<span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span>x0<span style='color:#808030; '>]</span>
    ldp    w4<span style='color:#808030; '>,</span> w5<span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span>x0<span style='color:#808030; '>,</span> <span style='color:#008c00; '>8</span><span style='color:#808030; '>]</span>

    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> load <span style='color:#008c00; '>128</span><span style='color:#808030; '>-</span>bit plain text
    ldp    w6<span style='color:#808030; '>,</span> w7<span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span>x1<span style='color:#808030; '>]</span>
    ldp    w8<span style='color:#808030; '>,</span> w9<span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span>x1<span style='color:#808030; '>,</span> <span style='color:#008c00; '>8</span><span style='color:#808030; '>]</span>
 
    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> <span style='color:#800000; font-weight:bold; '>xor</span> plaintext <span style='color:#004a43; '>with</span> key
    eor    w6<span style='color:#808030; '>,</span> w6<span style='color:#808030; '>,</span> w2          <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> x<span style='color:#808030; '>[</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>]</span> <span style='color:#808030; '>^</span><span style='color:#808030; '>=</span> k<span style='color:#808030; '>[</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>]</span><span style='color:#696969; '>;</span>
    eor    w7<span style='color:#808030; '>,</span> w7<span style='color:#808030; '>,</span> w3          <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> x<span style='color:#808030; '>[</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span> <span style='color:#808030; '>^</span><span style='color:#808030; '>=</span> k<span style='color:#808030; '>[</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span><span style='color:#696969; '>;</span>
    eor    w8<span style='color:#808030; '>,</span> w8<span style='color:#808030; '>,</span> w4          <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> x<span style='color:#808030; '>[</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>]</span> <span style='color:#808030; '>^</span><span style='color:#808030; '>=</span> k<span style='color:#808030; '>[</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>]</span><span style='color:#696969; '>;</span>
    eor    w9<span style='color:#808030; '>,</span> w9<span style='color:#808030; '>,</span> w5          <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> x<span style='color:#808030; '>[</span><span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span> <span style='color:#808030; '>^</span><span style='color:#808030; '>=</span> k<span style='color:#808030; '>[</span><span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span><span style='color:#696969; '>;</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>    w1<span style='color:#008c00; '>0</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>16</span>             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> i <span style='color:#808030; '>=</span> <span style='color:#008c00; '>16</span>
<span style='color:#e34adc; '>L0:</span>
    <span style='color:#800000; font-weight:bold; '>add</span>    w6<span style='color:#808030; '>,</span> w6<span style='color:#808030; '>,</span> w7          <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> x<span style='color:#808030; '>[</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>]</span> <span style='color:#808030; '>+</span><span style='color:#808030; '>=</span> x<span style='color:#808030; '>[</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span><span style='color:#696969; '>;</span>
    eor    w7<span style='color:#808030; '>,</span> w6<span style='color:#808030; '>,</span> w7<span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>ror</span> <span style='color:#008c00; '>27</span>  <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> x<span style='color:#808030; '>[</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>R<span style='color:#808030; '>(</span>x<span style='color:#808030; '>[</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span><span style='color:#008c00; '>27</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>^</span> x<span style='color:#808030; '>[</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>]</span><span style='color:#696969; '>;</span>
    <span style='color:#800000; font-weight:bold; '>add</span>    w8<span style='color:#808030; '>,</span> w8<span style='color:#808030; '>,</span> w9          <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> x<span style='color:#808030; '>[</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>]</span> <span style='color:#808030; '>+</span><span style='color:#808030; '>=</span> x<span style='color:#808030; '>[</span><span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span><span style='color:#696969; '>;</span>
    eor    w9<span style='color:#808030; '>,</span> w8<span style='color:#808030; '>,</span> w9<span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>ror</span> <span style='color:#008c00; '>24</span>  <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> x<span style='color:#808030; '>[</span><span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>R<span style='color:#808030; '>(</span>x<span style='color:#808030; '>[</span><span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span><span style='color:#008c00; '>24</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>^</span> x<span style='color:#808030; '>[</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>]</span><span style='color:#696969; '>;</span>
    <span style='color:#800000; font-weight:bold; '>add</span>    w8<span style='color:#808030; '>,</span> w8<span style='color:#808030; '>,</span> w7          <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> x<span style='color:#808030; '>[</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>]</span> <span style='color:#808030; '>+</span><span style='color:#808030; '>=</span> x<span style='color:#808030; '>[</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span><span style='color:#696969; '>;</span>
    <span style='color:#800000; font-weight:bold; '>ror</span>    w6<span style='color:#808030; '>,</span> w6<span style='color:#808030; '>,</span> <span style='color:#008c00; '>16</span>
    <span style='color:#800000; font-weight:bold; '>add</span>    w6<span style='color:#808030; '>,</span> w9<span style='color:#808030; '>,</span> w6          <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> x<span style='color:#808030; '>[</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>R<span style='color:#808030; '>(</span>x<span style='color:#808030; '>[</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span><span style='color:#008c00; '>16</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> x<span style='color:#808030; '>[</span><span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span><span style='color:#696969; '>;</span>
    eor    w9<span style='color:#808030; '>,</span> w6<span style='color:#808030; '>,</span> w9<span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>ror</span> <span style='color:#008c00; '>19</span>  <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> x<span style='color:#808030; '>[</span><span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>R<span style='color:#808030; '>(</span>x<span style='color:#808030; '>[</span><span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span><span style='color:#008c00; '>19</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>^</span> x<span style='color:#808030; '>[</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>]</span><span style='color:#696969; '>;</span>
    eor    w7<span style='color:#808030; '>,</span> w8<span style='color:#808030; '>,</span> w7<span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>ror</span> <span style='color:#008c00; '>25</span>  <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> x<span style='color:#808030; '>[</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>R<span style='color:#808030; '>(</span>x<span style='color:#808030; '>[</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span><span style='color:#008c00; '>25</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>^</span> x<span style='color:#808030; '>[</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>]</span><span style='color:#696969; '>;</span>
    <span style='color:#800000; font-weight:bold; '>ror</span>    w8<span style='color:#808030; '>,</span> w8<span style='color:#808030; '>,</span> <span style='color:#008c00; '>16</span>          <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> x<span style='color:#808030; '>[</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>R<span style='color:#808030; '>(</span>x<span style='color:#808030; '>[</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span><span style='color:#008c00; '>16</span><span style='color:#808030; '>)</span><span style='color:#696969; '>;</span>
    subs   w1<span style='color:#008c00; '>0</span><span style='color:#808030; '>,</span> w1<span style='color:#008c00; '>0</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span>         <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> i<span style='color:#808030; '>-</span><span style='color:#808030; '>-</span>
    bne    L0                  <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> i <span style='color:#808030; '>></span> <span style='color:#008c00; '>0</span>
  
    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> <span style='color:#800000; font-weight:bold; '>xor</span> cipher text <span style='color:#004a43; '>with</span> key
    eor    w6<span style='color:#808030; '>,</span> w6<span style='color:#808030; '>,</span> w2          <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> x<span style='color:#808030; '>[</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>]</span> <span style='color:#808030; '>^</span><span style='color:#808030; '>=</span> k<span style='color:#808030; '>[</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>]</span><span style='color:#696969; '>;</span>
    eor    w7<span style='color:#808030; '>,</span> w7<span style='color:#808030; '>,</span> w3          <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> x<span style='color:#808030; '>[</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span> <span style='color:#808030; '>^</span><span style='color:#808030; '>=</span> k<span style='color:#808030; '>[</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span><span style='color:#696969; '>;</span>
    eor    w8<span style='color:#808030; '>,</span> w8<span style='color:#808030; '>,</span> w4          <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> x<span style='color:#808030; '>[</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>]</span> <span style='color:#808030; '>^</span><span style='color:#808030; '>=</span> k<span style='color:#808030; '>[</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>]</span><span style='color:#696969; '>;</span>
    eor    w9<span style='color:#808030; '>,</span> w9<span style='color:#808030; '>,</span> w5          <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> x<span style='color:#808030; '>[</span><span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span> <span style='color:#808030; '>^</span><span style='color:#808030; '>=</span> k<span style='color:#808030; '>[</span><span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span><span style='color:#696969; '>;</span>
  
    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> save <span style='color:#008c00; '>128</span><span style='color:#808030; '>-</span>bit cipher text
    stp    w6<span style='color:#808030; '>,</span> w7<span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span>x1<span style='color:#808030; '>]</span> 
    stp    w8<span style='color:#808030; '>,</span> w9<span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span>x1<span style='color:#808030; '>,</span> <span style='color:#008c00; '>8</span><span style='color:#808030; '>]</span>
    <span style='color:#800000; font-weight:bold; '>ret</span> 
</pre>

<p><a href="https://github.com/odzhan/tinycrypt/tree/master/block/chaskey">Sources here.</a></p>
