
// test unit for SM4 block cipher
// odzhan

#include <stdio.h>
#include <stdint.h>
#include <string.h>

// 128-bit master key
uint8_t key[16]=
{ 0x01, 0x23, 0x45, 0x67, 0x89, 0xab, 0xcd, 0xef,
  0xfe, 0xdc, 0xba, 0x98, 0x76, 0x54, 0x32, 0x10 };
  
// 128-bit plaintext
uint8_t plain[16]=
{ 0x01, 0x23, 0x45, 0x67, 0x89, 0xab, 0xcd, 0xef,
  0xfe, 0xdc, 0xba, 0x98, 0x76, 0x54, 0x32, 0x10 };

// 128-bit ciphertext
uint8_t cipher[16]=  
{ 0x68, 0x1e, 0xdf, 0x34, 0xd2, 0x06, 0x96, 0x5e,
  0x86, 0xb3, 0xe9, 0x4f, 0x53, 0x6e, 0x42, 0x46 };
  
void sm4(void *mk, void *data);

int main(void) {
    uint8_t data[16];
    int     equ;
    
    memcpy(data, plain, 16);
    sm4(key, data);
    equ = (memcmp(cipher, data, 16)==0);
    printf ("SM4 test : %s\n", equ ? "OK" : "FAILED");    
    return 0;
}
