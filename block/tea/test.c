
// test unit for tea.c
// odzhan
#include <string.h>
#include <stdlib.h>
#include <stdint.h>
#include <stdio.h>

uint8_t key[16]=
{ 0xf2,0xbf,0x60,0x5c,0x1c,0xd0,0x72,0x70,
  0xeb,0xc5,0x13,0x45,0xab,0x38,0x3a,0x8f };

uint8_t plain[8]=
{ 0xad,0xc4,0xd9,0x80,0x35,0x96,0x89,0xcf };

uint8_t cipher[8]=
{ 0xb3,0xf1,0xb0,0x2b,0x11,0xed,0x23,0xc0 };

void tea(void *mk, void *data);

int main() {
    uint8_t data[8];
    int     equ;

    memcpy(data, plain, 8);
    tea(key, data);
    equ = (memcmp(data, cipher, 8)==0);
    printf("TEA test : %s\n", equ ? "OK" : "FAILED");
    return 0;
}
